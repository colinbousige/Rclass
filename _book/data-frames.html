<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>6 Data frames | Reproducible data treatment with R</title>
<meta name="author" content="Colin Bousige">
<meta name="generator" content="bookdown 0.25 with bs4_book()">
<meta property="og:title" content="6 Data frames | Reproducible data treatment with R">
<meta property="og:type" content="book">
<meta property="og:url" content="https://lmi.cnrs.fr/r/data-frames.html">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="6 Data frames | Reproducible data treatment with R">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="libs/plotly-binding-4.10.0/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-152051691-1"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-152051691-1');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
<meta name="description" content="blockquote {  background: #E9F9FF;  border-left: 5px solid #026086;  margin: 1.5em 10px;  padding: 0.5em 10px; }  6.1 Defining a data.frame  6.1.1 Defining a data.frame from vectors In R, the...">
<meta property="og:description" content="blockquote {  background: #E9F9FF;  border-left: 5px solid #026086;  margin: 1.5em 10px;  padding: 0.5em 10px; }  6.1 Defining a data.frame  6.1.1 Defining a data.frame from vectors In R, the...">
<meta name="twitter:description" content="blockquote {  background: #E9F9FF;  border-left: 5px solid #026086;  margin: 1.5em 10px;  padding: 0.5em 10px; }  6.1 Defining a data.frame  6.1.1 Defining a data.frame from vectors In R, the...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="An introduction">Reproducible data treatment with R</a>:
        <small class="text-muted">An introduction</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="about-the-class.html"><span class="header-section-number">1</span> About the class</a></li>
<li><a class="" href="a-little-reminder-on-statistics.html"><span class="header-section-number">2</span> A little reminder on Statistics</a></li>
<li><a class="" href="getting-ready.html"><span class="header-section-number">3</span> Getting ready</a></li>
<li><a class="" href="variables-booleans-and-strings.html"><span class="header-section-number">4</span> Variables, booleans and strings</a></li>
<li><a class="" href="vectors.html"><span class="header-section-number">5</span> Vectors</a></li>
<li><a class="active" href="data-frames.html"><span class="header-section-number">6</span> Data frames</a></li>
<li><a class="" href="readingwriting-all-kinds-of-files.html"><span class="header-section-number">7</span> Reading/writing all kinds of files</a></li>
<li><a class="" href="lists.html"><span class="header-section-number">8</span> Lists</a></li>
<li><a class="" href="functions.html"><span class="header-section-number">9</span> Functions</a></li>
<li><a class="" href="conditional-actions-and-loops.html"><span class="header-section-number">10</span> Conditional actions and loops</a></li>
<li><a class="" href="plotting.html"><span class="header-section-number">11</span> Plotting</a></li>
<li><a class="" href="colorplots.html"><span class="header-section-number">12</span> 3D color plots</a></li>
<li><a class="" href="fitting.html"><span class="header-section-number">13</span> Fitting</a></li>
<li><a class="" href="writing-documents-with-rmarkdown.html"><span class="header-section-number">14</span> Writing documents with Rmarkdown</a></li>
<li><a class="" href="graphical-interfaces-with-shiny.html"><span class="header-section-number">15</span> Graphical interfaces with Shiny</a></li>
<li><a class="" href="working-with-units-and-experimental-errors.html"><span class="header-section-number">16</span> Working with units and experimental errors</a></li>
<li><a class="" href="list-of-exercises.html"><span class="header-section-number">17</span> List of exercises</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/colinbousige/Rclass">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="data-frames" class="section level1" number="6">
<h1>
<span class="header-section-number">6</span> Data frames<a class="anchor" aria-label="anchor" href="#data-frames"><i class="fas fa-link"></i></a>
</h1>
<style type="text/css">
blockquote {
  background: #E9F9FF;
  border-left: 5px solid #026086;
  margin: 1.5em 10px;
  padding: 0.5em 10px;
}
</style>
<div id="defining-a-data.frame" class="section level2" number="6.1">
<h2>
<span class="header-section-number">6.1</span> Defining a data.frame<a class="anchor" aria-label="anchor" href="#defining-a-data.frame"><i class="fas fa-link"></i></a>
</h2>
<div id="defining-a-data.frame-from-vectors" class="section level3" number="6.1.1">
<h3>
<span class="header-section-number">6.1.1</span> Defining a data.frame from vectors<a class="anchor" aria-label="anchor" href="#defining-a-data.frame-from-vectors"><i class="fas fa-link"></i></a>
</h3>
<p>In R, the principal object is <em>the data</em>. Hence the <code class="sourceCode r">data.frame</code> object, which is basically a table of vectors. A <code class="sourceCode r">data.frame</code> is a list presented under the form of a table – <em>i.e.</em> a spreadsheet. On a day-to-day basis, you will either define <code class="sourceCode r">data.frame</code> from existing vectors or other <code class="sourceCode r">data.frame</code>, or define a <code class="sourceCode r">data.frame</code> from a file (text, Excel…). In this example, we use <a href="Data/test.dat" download target="_blank">test.dat</a> and <a href="Data/test.xlsx" download target="_blank">test.xlsx</a>.</p>
<p>To define a <code>data.frame</code> from known vectors, we just have to do:</p>
<div class="sourceCode" id="cb236"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="va">pi</span>, <span class="va">pi</span>, length <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> 
<span class="va">y</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="co"># df is a data.frame (a table)</span>
<span class="va">df</span></code></pre></div>
<pre><code>##            x             y
## 1 -3.1415927 -1.224647e-16
## 2 -1.8849556 -9.510565e-01
## 3 -0.6283185 -5.877853e-01
## 4  0.6283185  5.877853e-01
## 5  1.8849556  9.510565e-01
## 6  3.1415927  1.224647e-16</code></pre>
<p>Then some information about our table are readily accessible, like:</p>
<ul>
<li>The dimension, the number of rows and columns:</li>
</ul>
<div class="sourceCode" id="cb238"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 6 2</code></pre>
<pre><code>## [1] 6</code></pre>
<pre><code>## [1] 2</code></pre>
<ul>
<li>Print the first and last 3 values</li>
</ul>
<div class="sourceCode" id="cb242"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">3</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##            x             y
## 1 -3.1415927 -1.224647e-16
## 2 -1.8849556 -9.510565e-01
## 3 -0.6283185 -5.877853e-01</code></pre>
<pre><code>##           x            y
## 4 0.6283185 5.877853e-01
## 5 1.8849556 9.510565e-01
## 6 3.1415927 1.224647e-16</code></pre>
<ul>
<li>Print some information on <code>df</code>
</li>
</ul>
<div class="sourceCode" id="cb245"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></code></pre></div>
<pre><code>## 'data.frame':    6 obs. of  2 variables:
##  $ x: num  -3.142 -1.885 -0.628 0.628 1.885 ...
##  $ y: num  -1.22e-16 -9.51e-01 -5.88e-01 5.88e-01 9.51e-01 ...</code></pre>
<ul>
<li>Print some statistics on <code>df</code>
</li>
</ul>
<div class="sourceCode" id="cb247"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></code></pre></div>
<pre><code>##        x                y          
##  Min.   :-3.142   Min.   :-0.9511  
##  1st Qu.:-1.571   1st Qu.:-0.4408  
##  Median : 0.000   Median : 0.0000  
##  Mean   : 0.000   Mean   : 0.0000  
##  3rd Qu.: 1.571   3rd Qu.: 0.4408  
##  Max.   : 3.142   Max.   : 0.9511</code></pre>
<p>If not defined when creating the <code>data.frame</code>, the column names will be by default the vector names. To specify your own column names, do it when creating the <code>data.frame</code>:</p>
<div class="sourceCode" id="cb249"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>xxx <span class="op">=</span> <span class="va">x</span>, yyy <span class="op">=</span> <span class="va">y</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>##         xxx           yyy
## 1 -3.141593 -1.224647e-16
## 2 -1.884956 -9.510565e-01</code></pre>
<p>Or, once it’s created, do it using <code class="sourceCode r"><span class="fu">names</span>()</code></p>
<div class="sourceCode" id="cb251"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "xxx" "yyy"</code></pre>
<div class="sourceCode" id="cb253"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="st">"Y"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>##           X             Y
## 1 -3.141593 -1.224647e-16
## 2 -1.884956 -9.510565e-01</code></pre>
</div>
<div id="defining-a-data.frame-from-a-file" class="section level3" number="6.1.2">
<h3>
<span class="header-section-number">6.1.2</span> Defining a data.frame from a file<a class="anchor" aria-label="anchor" href="#defining-a-data.frame-from-a-file"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s say we have <code>test.dat</code> that looks like this:</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb255-1"><a href="data-frames.html#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bash code:</span></span>
<span id="cb255-2"><a href="data-frames.html#cb255-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> Data/test.dat</span></code></pre></div>
<pre><code>## x   y
## 1   2
## 2   3</code></pre>
<ul>
<li>Then, to read this file into a <code>data.frame</code>, we will use <code class="sourceCode r"><span class="fu">read.table</span>()</code>. If you don’t specify that the file contains a header, <code class="sourceCode r"><span class="fu">read.table</span>()</code> will default to attributing column names that will be V1, V2, V3, etc:</li>
</ul>
<div class="sourceCode" id="cb257"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"Data/test.dat"</span><span class="op">)</span></code></pre></div>
<pre><code>##   V1 V2
## 1  x  y
## 2  1  2
## 3  2  3</code></pre>
<ul>
<li>If your file contains column names, you will use first line as column names like so:</li>
</ul>
<div class="sourceCode" id="cb259"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"Data/test.dat"</span>, header<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>##   x y
## 1 1 2
## 2 2 3</code></pre>
<ul>
<li>If you want to skip some lines before starting the reading, use <code>skip</code>:</li>
</ul>
<div class="sourceCode" id="cb261"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"Data/test.dat"</span>, skip<span class="op">=</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code>##   V1 V2
## 1  1  2
## 2  2  3</code></pre>
<ul>
<li>You can specify your own column names using <code>col.names</code>:</li>
</ul>
<div class="sourceCode" id="cb263"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"Data/test.dat"</span>, skip<span class="op">=</span><span class="fl">1</span>, col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##   A B
## 1 1 2
## 2 2 3</code></pre>
<ul>
<li><p>You can type <code><a href="https://rdrr.io/r/utils/read.table.html">?read.table</a></code> for more options.</p></li>
<li><p>Now, to read an Excel file, use the <code>readxl</code> library:</p></li>
</ul>
<div class="sourceCode" id="cb265"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span> <span class="co"># load readxl from tidyverse to read Excel files</span>
<span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"Data/test.xlsx"</span>, sheet<span class="op">=</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 2
##        x      y
##    &lt;dbl&gt;  &lt;dbl&gt;
##  1     1  5.21 
##  2     2  6.55 
##  3     3  3.71 
##  4     4  0.216
##  5     5  0.205
##  6     6  4.60 
##  7     7 10.3  
##  8     8 12.9  
##  9     9 11.1  
## 10    10  7.28</code></pre>
<div class="sourceCode" id="cb267"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"Data/test.xlsx"</span>, sheet<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 2
##   hello  world   
##   &lt;chr&gt;  &lt;chr&gt;   
## 1 ac     th      
## 2 asc    thh     
## 3 ascsa  dthdh   
## 4 ascacs dthtdhdh</code></pre>
<hr>
</div>
</div>
<div id="accessing-values-1" class="section level2" number="6.2">
<h2>
<span class="header-section-number">6.2</span> Accessing values<a class="anchor" aria-label="anchor" href="#accessing-values-1"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>Like with vectors, accessing values is done using the <code>[]</code> notation, except that here there are two indexes: <code>df[row, column]</code>:</li>
</ul>
<div class="sourceCode" id="cb269"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">]</span></code></pre></div>
<pre><code>## [1] -0.6283185</code></pre>
<ul>
<li>In general however, what you want is to access a given column, by its index:</li>
</ul>
<div class="sourceCode" id="cb271"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></code></pre></div>
<pre><code>## [1] -3.1415927 -1.8849556 -0.6283185  0.6283185  1.8849556  3.1415927</code></pre>
<div class="sourceCode" id="cb273"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="co"># this is a vector too</span></code></pre></div>
<pre><code>## [1] -3.1415927 -1.8849556 -0.6283185  0.6283185  1.8849556  3.1415927</code></pre>
<ul>
<li>Or, <strong>preferably</strong>, by its name using the <code>$</code> notation:</li>
</ul>
<div class="sourceCode" id="cb275"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">$</span><span class="va">X</span></code></pre></div>
<pre><code>## [1] -3.1415927 -1.8849556 -0.6283185  0.6283185  1.8849556  3.1415927</code></pre>
<ul>
<li>Finally, you may want to apply filters on your table:</li>
</ul>
<div class="sourceCode" id="cb277"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">X</span> <span class="op">&lt;</span> <span class="fl">0</span>, <span class="op">]</span></code></pre></div>
<pre><code>##            X             Y
## 1 -3.1415927 -1.224647e-16
## 2 -1.8849556 -9.510565e-01
## 3 -0.6283185 -5.877853e-01</code></pre>
<ul>
<li>Using the function <code class="sourceCode r"><span class="fu">subset</span>()</code>, the conditions are applied on column names (no need for df$col_name here, while you need it in the above expression):</li>
</ul>
<div class="sourceCode" id="cb279"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">X</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code>##          X            Y
## 5 1.884956 9.510565e-01
## 6 3.141593 1.224647e-16</code></pre>
<div class="sourceCode" id="cb281"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">X</span><span class="op">&gt;</span><span class="fl">1</span>, select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##          X
## 5 1.884956
## 6 3.141593</code></pre>
<hr>
</div>
<div id="adding-columns-or-rows" class="section level2" number="6.3">
<h2>
<span class="header-section-number">6.3</span> Adding columns or rows<a class="anchor" aria-label="anchor" href="#adding-columns-or-rows"><i class="fas fa-link"></i></a>
</h2>
<div id="adding-columns" class="section level3" number="6.3.1">
<h3>
<span class="header-section-number">6.3.1</span> Adding columns<a class="anchor" aria-label="anchor" href="#adding-columns"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>To add a column, just attribute a value to an column that do not exist yet, it will be created:</li>
</ul>
<div class="sourceCode" id="cb283"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Adding columns</span>
<span class="va">df</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span>
<span class="va">df</span><span class="op">$</span><span class="va">z</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span>
<span class="va">df</span></code></pre></div>
<pre><code>##            x             y         z
## 1 -3.1415927 -1.224647e-16 9.8696044
## 2 -1.8849556 -9.510565e-01 3.5530576
## 3 -0.6283185 -5.877853e-01 0.3947842
## 4  0.6283185  5.877853e-01 0.3947842
## 5  1.8849556  9.510565e-01 3.5530576
## 6  3.1415927  1.224647e-16 9.8696044</code></pre>
<ul>
<li>You can also create a <code>data.frame</code> of a <code>data.frame</code>:</li>
</ul>
<div class="sourceCode" id="cb285"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">df</span>, z<span class="op">=</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span>, u<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##            x             y         z       z.1         u
## 1 -3.1415927 -1.224647e-16 9.8696044 9.8696044 -1.000000
## 2 -1.8849556 -9.510565e-01 3.5530576 3.5530576 -0.309017
## 3 -0.6283185 -5.877853e-01 0.3947842 0.3947842  0.809017
## 4  0.6283185  5.877853e-01 0.3947842 0.3947842  0.809017
## 5  1.8849556  9.510565e-01 3.5530576 3.5530576 -0.309017
## 6  3.1415927  1.224647e-16 9.8696044 9.8696044 -1.000000</code></pre>
<ul>
<li>Finally, you can use the <code class="sourceCode r"><span class="fu">cbind</span>()</code> function to bind two <code>data.frame</code> column-wise:</li>
</ul>
<div class="sourceCode" id="cb287"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, b <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">df2</span><span class="op">)</span></code></pre></div>
<pre><code>##            x             y         z a b
## 1 -3.1415927 -1.224647e-16 9.8696044 1 1
## 2 -1.8849556 -9.510565e-01 3.5530576 2 2
## 3 -0.6283185 -5.877853e-01 0.3947842 3 3
## 4  0.6283185  5.877853e-01 0.3947842 4 4
## 5  1.8849556  9.510565e-01 3.5530576 5 5
## 6  3.1415927  1.224647e-16 9.8696044 6 6</code></pre>
</div>
<div id="adding-rows" class="section level3" number="6.3.2">
<h3>
<span class="header-section-number">6.3.2</span> Adding rows<a class="anchor" aria-label="anchor" href="#adding-rows"><i class="fas fa-link"></i></a>
</h3>
<p>For this, use the <code class="sourceCode r"><span class="fu">rbind</span>()</code> function.</p>
<blockquote>
<p><strong>Attention:</strong> the two data.frame must have the same number of columns <em><strong>and</strong></em> the same column names.</p>
</blockquote>
<div class="sourceCode" id="cb289"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">df</span><span class="op">)</span></code></pre></div>
<pre><code>##             x             y         z
## 1  -3.1415927 -1.224647e-16 9.8696044
## 2  -1.8849556 -9.510565e-01 3.5530576
## 3  -0.6283185 -5.877853e-01 0.3947842
## 4   0.6283185  5.877853e-01 0.3947842
## 5   1.8849556  9.510565e-01 3.5530576
## 6   3.1415927  1.224647e-16 9.8696044
## 7  -3.1415927 -1.224647e-16 9.8696044
## 8  -1.8849556 -9.510565e-01 3.5530576
## 9  -0.6283185 -5.877853e-01 0.3947842
## 10  0.6283185  5.877853e-01 0.3947842
## 11  1.8849556  9.510565e-01 3.5530576
## 12  3.1415927  1.224647e-16 9.8696044</code></pre>
</div>
<div id="deleting-rowscolumns" class="section level3" number="6.3.3">
<h3>
<span class="header-section-number">6.3.3</span> Deleting rows/columns<a class="anchor" aria-label="anchor" href="#deleting-rowscolumns"><i class="fas fa-link"></i></a>
</h3>
<p>This works like with vectors:</p>
<div class="sourceCode" id="cb291"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>,<span class="op">]</span></code></pre></div>
<pre><code>##            x             y         z
## 2 -1.8849556 -9.510565e-01 3.5530576
## 3 -0.6283185 -5.877853e-01 0.3947842
## 4  0.6283185  5.877853e-01 0.3947842
## 5  1.8849556  9.510565e-01 3.5530576
## 6  3.1415927  1.224647e-16 9.8696044</code></pre>
<div class="sourceCode" id="cb293"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span></code></pre></div>
<pre><code>##               y         z
## 1 -1.224647e-16 9.8696044
## 2 -9.510565e-01 3.5530576
## 3 -5.877853e-01 0.3947842
## 4  5.877853e-01 0.3947842
## 5  9.510565e-01 3.5530576
## 6  1.224647e-16 9.8696044</code></pre>
<hr>
</div>
</div>
<div id="tidy-up" class="section level2" number="6.4">
<h2>
<span class="header-section-number">6.4</span> Tidy up!<a class="anchor" aria-label="anchor" href="#tidy-up"><i class="fas fa-link"></i></a>
</h2>
<div id="what-is-tidy-data" class="section level3" number="6.4.1">
<h3>
<span class="header-section-number">6.4.1</span> What is tidy data?<a class="anchor" aria-label="anchor" href="#what-is-tidy-data"><i class="fas fa-link"></i></a>
</h3>
<p><strong>A good practice in R is to <em>tidy</em> your data.</strong> R follows a set of conventions that makes one layout of tabular data much easier to work with than others. Your data will be easier to work with in R if it follows three rules:</p>
<ul>
<li>Each variable in the data set is placed in its own column</li>
<li>Each observation is placed in its own row</li>
<li>Each value is placed in its own cell</li>
</ul>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:tidy"></span>
<img src="Plots/tidy.png" alt="Illustration of tidy data." width="100%"><p class="caption">
Figure 6.1: Illustration of tidy data.
</p>
</div>
<p>Data that satisfies these rules is known as tidy data: you see that thanks to this representation, a 2D table can handle an arbitrary number of variables – this avoids using multi-dimensional arrays or multi-tab Excel documents. Note that it does’t matter if a value is repeated in a column.</p>
<p>Here is an example:</p>
<div class="sourceCode" id="cb295"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"Data/population.csv"</span><span class="op">)</span>
<span class="va">df</span> <span class="co"># is not tidy</span></code></pre></div>
<details><summary>
Show output
</summary><pre><code>##   year Angers Bordeaux  Brest  Dijon Grenoble LeHavre LeMans  Lille   Lyon
## 1 1962 115273   278403 136104 135694   156707  187845 132181 239955 535746
## 2 1968 128557   266662 154023 145357   161616  207150 143246 238554 527800
## 3 1975 137591   223131 166826 151705   166037  217882 152285 219204 456716
## 4 1982 136038   208159 156060 140942   156637  199388 147697 196705 413095
## 5 1990 141404   210336 147956 146703   150758  195854 145502 198691 415487
## 6 1999 151279   215363 149634 149867   153317  190905 146105 212597 445452
## 7 2007 151108   235178 142722 151543   156793  179751 144164 225789 472330
## 8 2012 149017   241287 139676 152071   158346  173142 143599 228652 496343
##   Marseille Montpellier Nantes   Nice   Paris  Reims Rennes Saint.Etienne
## 1    778071      118864 240048 292958 2790091 134856 151948        210311
## 2    889029      161910 260244 322442 2590771 154534 180943        223223
## 3    908600      191354 256693 344481 2299830 178381 198305        220181
## 4    874436      197231 240539 337085 2176243 177234 194656        204955
## 5    800550      207996 244995 342439 2152423 180620 197536        199396
## 6    798430      225392 270251 342738 2125246 187206 206229        180210
## 7    852395      253712 283025 348721 2193030 183500 207922        175318
## 8    852516      268456 291604 343629 2240621 181893 209860        171483
##   Strasbourg Toulon Toulouse
## 1     228971 161797   323724
## 2     249396 174746   370796
## 3     253384 181801   373796
## 4     248712 179423   347995
## 5     252338 167619   358688
## 6     264115 160639   390350
## 7     272123 166537   439453
## 8     274394 164899   453317</code></pre>
</details><p><br></p>
<div class="sourceCode" id="cb297"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">df</span>, cols<span class="op">=</span><span class="op">-</span><span class="va">year</span>, names_to<span class="op">=</span><span class="st">"city"</span>, values_to<span class="op">=</span><span class="st">"pop"</span><span class="op">)</span>
<span class="va">df</span> <span class="co">#is tidy</span></code></pre></div>
<details><summary>
Show output
</summary><pre><code>## # A tibble: 160 × 3
##     year city         pop
##    &lt;int&gt; &lt;chr&gt;      &lt;int&gt;
##  1  1962 Angers    115273
##  2  1962 Bordeaux  278403
##  3  1962 Brest     136104
##  4  1962 Dijon     135694
##  5  1962 Grenoble  156707
##  6  1962 LeHavre   187845
##  7  1962 LeMans    132181
##  8  1962 Lille     239955
##  9  1962 Lyon      535746
## 10  1962 Marseille 778071
## # … with 150 more rows</code></pre>
</details><p><br></p>
<div class="sourceCode" id="cb299"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># is not tidy</span>
<span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span><span class="va">df</span>, names_from<span class="op">=</span><span class="st">"city"</span>, values_from<span class="op">=</span><span class="st">"pop"</span><span class="op">)</span></code></pre></div>
<details><summary>
Show output
</summary><pre><code>## # A tibble: 8 × 21
##    year Angers Bordeaux  Brest  Dijon Grenoble LeHavre LeMans  Lille   Lyon
##   &lt;int&gt;  &lt;int&gt;    &lt;int&gt;  &lt;int&gt;  &lt;int&gt;    &lt;int&gt;   &lt;int&gt;  &lt;int&gt;  &lt;int&gt;  &lt;int&gt;
## 1  1962 115273   278403 136104 135694   156707  187845 132181 239955 535746
## 2  1968 128557   266662 154023 145357   161616  207150 143246 238554 527800
## 3  1975 137591   223131 166826 151705   166037  217882 152285 219204 456716
## 4  1982 136038   208159 156060 140942   156637  199388 147697 196705 413095
## 5  1990 141404   210336 147956 146703   150758  195854 145502 198691 415487
## 6  1999 151279   215363 149634 149867   153317  190905 146105 212597 445452
## 7  2007 151108   235178 142722 151543   156793  179751 144164 225789 472330
## 8  2012 149017   241287 139676 152071   158346  173142 143599 228652 496343
## # … with 11 more variables: Marseille &lt;int&gt;, Montpellier &lt;int&gt;, Nantes &lt;int&gt;,
## #   Nice &lt;int&gt;, Paris &lt;int&gt;, Reims &lt;int&gt;, Rennes &lt;int&gt;, Saint.Etienne &lt;int&gt;,
## #   Strasbourg &lt;int&gt;, Toulon &lt;int&gt;, Toulouse &lt;int&gt;</code></pre>
</details><p><br></p>
<p>You can find more information on data import and <a href="https://garrettgman.github.io/tidying/">tidyness</a> on the <a href="https://github.com/rstudio/cheatsheets/blob/main/data-import.pdf">data-import cheatsheet</a> and on the <a href="http://www.sthda.com/english/wiki/tidyr-crucial-step-reshaping-data-with-r-for-easier-analyses">tidyr</a> package.</p>
</div>
<div id="tibbles" class="section level3" number="6.4.2">
<h3>
<span class="header-section-number">6.4.2</span> Tibbles<a class="anchor" aria-label="anchor" href="#tibbles"><i class="fas fa-link"></i></a>
</h3>
<p>A <code class="sourceCode r">tibble</code> is an enhanced version of the <code class="sourceCode r">data.frame</code> provided by the <code>tibble</code> package (which is part of the <code>tidyverse</code>). The main advantage of <code class="sourceCode r">tibble</code> is that it has easier initialization and nicer printing than <code class="sourceCode r">data.frame</code>. Moreover, the performance are also enhanced for the reading from files with <code class="sourceCode r"><span class="fu">read_csv</span>()</code>, <code class="sourceCode r"><span class="fu">read_tsv</span>()</code>, <code class="sourceCode r"><span class="fu">read_table</span>()</code> and <code class="sourceCode r"><span class="fu">read_delim</span>()</code> that do the same things as their <code>read.xx()</code> counterparts and return a <code>tibble</code>. Otherwise, the handling is basically the same.</p>
<p>More on tibbles <a href="https://cran.r-project.org/web/packages/tibble/vignettes/tibble.html">here</a>.</p>
<ul>
<li>Note that when initializing <code>tibble</code>s, the construction is iterative. It means that when creating a second column, one can refer to the first one that was created. This does’t work with <code>data.frame</code>s.</li>
</ul>
<div class="sourceCode" id="cb301"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1e3</span><span class="op">)</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in data.frame(x = runif(1000), y = cumsum(x)): object 'x' not found</code></pre>
<div class="sourceCode" id="cb303"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1e3</span><span class="op">)</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="va">tib</span></code></pre></div>
<pre><code>## # A tibble: 1,000 × 2
##        x     y
##    &lt;dbl&gt; &lt;dbl&gt;
##  1 0.590 0.590
##  2 0.929 1.52 
##  3 0.462 1.98 
##  4 0.395 2.38 
##  5 0.449 2.83 
##  6 0.553 3.38 
##  7 0.188 3.57 
##  8 0.488 4.06 
##  9 0.686 4.74 
## 10 0.817 5.56 
## # … with 990 more rows</code></pre>
<blockquote>
<p><strong>Attention</strong></p>
</blockquote>
<p><code>Tibble</code>s are quite strict about subsetting. <code>[</code> always returns another <code>tibble</code>. Contrast this with a data frame: sometimes <code>[</code> returns a data frame and sometimes it just returns a vector:</p>
<div class="sourceCode" id="cb305"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">tib</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co"># is a vector</span></code></pre></div>
<pre><code>## [1] 0.5902493 0.9292955 0.4618716 0.3951280 0.4486365 0.5533962</code></pre>
<div class="sourceCode" id="cb307"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">tib</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>  <span class="co"># is a tibble</span></code></pre></div>
<pre><code>## # A tibble: 6 × 1
##       x
##   &lt;dbl&gt;
## 1 0.590
## 2 0.929
## 3 0.462
## 4 0.395
## 5 0.449
## 6 0.553</code></pre>
<p>Unless you want to get a <code>tibble</code>, I recommend always using the <code>$</code> notation when you want to get a column as a vector to avoid problems.</p>
<ul>
<li>Another interesting feature of <code>tibble</code>s is that their columns can contain vectors, like usual, but also lists of any R objects like other tibbles, <code class="sourceCode r"><span class="fu">nls</span>()</code> objects, etc. This is called “nesting”, and you can nest and un-nest <code>tibble</code>s using these explicit functions:</li>
</ul>
<div class="sourceCode" id="cb309"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tib1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, y<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>
<span class="va">tib2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, y<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>
<span class="va">tib</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>number<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">tib1</span>, <span class="va">tib2</span><span class="op">)</span><span class="op">)</span>
<span class="va">tib</span></code></pre></div>
<pre><code>## # A tibble: 2 × 2
##   number data            
##    &lt;int&gt; &lt;list&gt;          
## 1      1 &lt;tibble [3 × 2]&gt;
## 2      2 &lt;tibble [5 × 2]&gt;</code></pre>
<div class="sourceCode" id="cb311"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tib_unnested</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span><span class="op">(</span><span class="va">tib</span>, <span class="va">data</span><span class="op">)</span>
<span class="va">tib_unnested</span></code></pre></div>
<pre><code>## # A tibble: 8 × 3
##   number     x     y
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;
## 1      1     1     1
## 2      1     2     2
## 3      1     3     3
## 4      2     1     1
## 5      2     2     2
## 6      2     3     3
## 7      2     4     4
## 8      2     5     5</code></pre>
<div class="sourceCode" id="cb313"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tib_unnested_renested</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">nest</a></span><span class="op">(</span><span class="va">tib_unnested</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">number</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span>
<span class="va">tib_unnested_renested</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##       x data            
##   &lt;int&gt; &lt;list&gt;          
## 1     1 &lt;tibble [2 × 2]&gt;
## 2     2 &lt;tibble [2 × 2]&gt;
## 3     3 &lt;tibble [2 × 2]&gt;
## 4     4 &lt;tibble [1 × 2]&gt;
## 5     5 &lt;tibble [1 × 2]&gt;</code></pre>
<div class="sourceCode" id="cb315"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tib_unnested_renested</span><span class="op">$</span><span class="va">data</span> <span class="co"># The `data` column is a list</span></code></pre></div>
<pre><code>## [[1]]
## # A tibble: 2 × 2
##   number     y
##    &lt;int&gt; &lt;int&gt;
## 1      1     1
## 2      2     1
## 
## [[2]]
## # A tibble: 2 × 2
##   number     y
##    &lt;int&gt; &lt;int&gt;
## 1      1     2
## 2      2     2
## 
## [[3]]
## # A tibble: 2 × 2
##   number     y
##    &lt;int&gt; &lt;int&gt;
## 1      1     3
## 2      2     3
## 
## [[4]]
## # A tibble: 1 × 2
##   number     y
##    &lt;int&gt; &lt;int&gt;
## 1      2     4
## 
## [[5]]
## # A tibble: 1 × 2
##   number     y
##    &lt;int&gt; &lt;int&gt;
## 1      2     5</code></pre>
<hr>
</div>
</div>
<div id="operations-in-the-tidyverse" class="section level2" number="6.5">
<h2>
<span class="header-section-number">6.5</span> Operations in the tidyverse<a class="anchor" aria-label="anchor" href="#operations-in-the-tidyverse"><i class="fas fa-link"></i></a>
</h2>
<p>In the end, base R and the <code>tidyverse</code> package provide many efficient functions to perform most of the tasks you would want to perform recursively, thus allowing avoiding explicit for loops.</p>
<p>Here are some examples, and you will find much more <a href="https://cran.r-project.org/web/packages/dplyr/vignettes/dplyr.html">here</a>. Take a look at the cheatsheets on <a href="https://github.com/rstudio/cheatsheets/raw/master/data-import.pdf">tidyr</a> and on <a href="https://github.com/rstudio/cheatsheets/raw/master/data-transformation.pdf">dplyr</a>, it’s really helpful.</p>
<p>Let’s work on this <code>tibble</code>:</p>
<div class="sourceCode" id="cb317"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Let's create a random tibble</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">500</span>
<span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">N</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span>, 
             y     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">*</span><span class="fl">3</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, 
             signx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">x</span><span class="op">&gt;</span><span class="fl">0</span>,<span class="st">"positive"</span>,<span class="st">"negative"</span><span class="op">)</span>,
             signy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">y</span><span class="op">&gt;</span><span class="fl">0</span>,<span class="st">"positive"</span>,<span class="st">"negative"</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">dt</span></code></pre></div>
<pre><code>## # A tibble: 1,500 × 4
##         x       y signx    signy   
##     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
##  1 -0.430  0.785  negative positive
##  2  0.417 -0.881  positive negative
##  3  0.572 -0.0317 positive negative
##  4 -0.730  0.897  negative positive
##  5  0.715 -0.598  positive negative
##  6  0.132  0.0621 positive positive
##  7 -0.626  0.119  negative positive
##  8 -0.828  0.728  negative positive
##  9 -0.835  0.792  negative positive
## 10  0.355  0.757  positive positive
## # … with 1,490 more rows</code></pre>
<div id="the-pipe-operator" class="section level3" number="6.5.1">
<h3>
<span class="header-section-number">6.5.1</span> The pipe operator<a class="anchor" aria-label="anchor" href="#the-pipe-operator"><i class="fas fa-link"></i></a>
</h3>
<p>In the following, we will introduce the pipe operator from the <code>magrittr</code> package: <code class="sourceCode r"><span class="sc">%&gt;%</span></code>.
This operator allows a clear syntax for successive operations, as “what is on the left of the operator is given as first argument of what is on the right”. It is thus a good habit to write each operation on a separate line to facilitate the reading. This is particularly helpful when performing multiple nested operations. For example, <code class="sourceCode r"><span class="fu">summary</span>(<span class="fu">head</span>(<span class="fu">tail</span>(dt),<span class="dv">2</span>))</code>, which is hard to read, would translate to:</p>
<div class="sourceCode" id="cb319"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Note that the 4.1 version of R introduced a native pipe operator: <code class="sourceCode r"><span class="sc">|&gt;</span></code>. However, for backward compatibility with all my previous code I still stick to the <code>magrittr</code> version <code>%&gt;%</code>, but that’s not the only reason. Indeed, in base R’s pipe, the piped object can only be given as first argument to the function on the right. This is also the default behavior of <code>%&gt;%</code>, but <code>%&gt;%</code> allows for retrieving the piped object with the operator <code>.</code>.</p>
<p>Silly example:</p>
<div class="sourceCode" id="cb320"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="st">"Hello"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"o"</span>, <span class="st">"e"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "e"</code></pre>
<div class="sourceCode" id="cb322"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="st">"Hello"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"o"</span>, <span class="st">"e"</span>, <span class="va">.</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Helle"</code></pre>
</div>
<div id="sampling-data" class="section level3" number="6.5.2">
<h3>
<span class="header-section-number">6.5.2</span> Sampling data<a class="anchor" aria-label="anchor" href="#sampling-data"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb324"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>  <span class="co"># by index</span></code></pre></div>
<pre><code>## # A tibble: 3 × 4
##        x       y signx    signy   
##    &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
## 1 -0.430  0.785  negative positive
## 2  0.417 -0.881  positive negative
## 3  0.572 -0.0317 positive negative</code></pre>
<div class="sourceCode" id="cb326"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html">sample_n</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="co"># randomly</span></code></pre></div>
<pre><code>## # A tibble: 3 × 4
##        x        y signx    signy   
##    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
## 1 -0.430 -0.00247 negative negative
## 2 -0.192 -0.799   negative negative
## 3 -0.965 -0.377   negative negative</code></pre>
</div>
<div id="operations-on-groups-of-a-variable" class="section level3" number="6.5.3">
<h3>
<span class="header-section-number">6.5.3</span> Operations on groups of a variable<a class="anchor" aria-label="anchor" href="#operations-on-groups-of-a-variable"><i class="fas fa-link"></i></a>
</h3>
<p><code class="sourceCode r"><span class="fu">group_by</span>(column)</code> groups by similar values of the wanted column(s) and performs the next operations on each element of the group successively.</p>
<div class="sourceCode" id="cb328"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">signx</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html">sample_n</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
## # Groups:   signx [2]
##        x       y signx    signy   
##    &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
## 1 -0.402 -0.0811 negative negative
## 2 -0.403  0.387  negative positive
## 3 -0.760  0.434  negative positive
## 4  0.316 -0.658  positive negative
## 5  0.853  0.160  positive positive
## 6  0.825 -0.285  positive negative</code></pre>
<div class="sourceCode" id="cb330"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">signx</span>, <span class="va">signy</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html">sample_n</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 12 × 4
## # Groups:   signx, signy [4]
##          x      y signx    signy   
##      &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
##  1 -0.514  -0.593 negative negative
##  2 -0.752  -0.628 negative negative
##  3 -0.788  -0.279 negative negative
##  4 -0.717   0.689 negative positive
##  5 -0.534   0.293 negative positive
##  6 -0.775   0.876 negative positive
##  7  0.566  -0.895 positive negative
##  8  0.0665 -0.878 positive negative
##  9  0.612  -0.483 positive negative
## 10  0.0327  0.694 positive positive
## 11  0.860   0.583 positive positive
## 12  0.636   0.940 positive positive</code></pre>
</div>
<div id="summary-by-groups-of-a-variable" class="section level3" number="6.5.4">
<h3>
<span class="header-section-number">6.5.4</span> Summary by groups of a variable<a class="anchor" aria-label="anchor" href="#summary-by-groups-of-a-variable"><i class="fas fa-link"></i></a>
</h3>
<p><code class="sourceCode r"><span class="fu">summarise</span>()</code> returns a <strong>single value</strong> for each element of the groups.</p>
<div class="sourceCode" id="cb332"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">signx</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>count  <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,
              mean_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, 
              sd_x   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 4
##   signx    count mean_x  sd_x
##   &lt;chr&gt;    &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt;
## 1 negative   804 -0.498 0.292
## 2 positive   696  0.538 0.287</code></pre>
<div class="sourceCode" id="cb334"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">signx</span>, <span class="va">signy</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>count  <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,
              mean_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, 
              mean_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 5
## # Groups:   signx [2]
##   signx    signy    count mean_x mean_y
##   &lt;chr&gt;    &lt;chr&gt;    &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1 negative negative   412 -0.498 -0.510
## 2 negative positive   392 -0.497  0.497
## 3 positive negative   340  0.530 -0.516
## 4 positive positive   356  0.546  0.466</code></pre>
</div>
<div id="sorting" class="section level3" number="6.5.5">
<h3>
<span class="header-section-number">6.5.5</span> Sorting<a class="anchor" aria-label="anchor" href="#sorting"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb336"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 1,500 × 4
##         x       y signx    signy   
##     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
##  1 -0.999 -0.936  negative negative
##  2 -0.999  0.251  negative positive
##  3 -0.999 -0.779  negative negative
##  4 -0.998 -0.921  negative negative
##  5 -0.998 -0.0853 negative negative
##  6 -0.998 -0.646  negative negative
##  7 -0.991  0.0744 negative positive
##  8 -0.991  0.805  negative positive
##  9 -0.991  0.808  negative positive
## 10 -0.988 -0.360  negative negative
## # … with 1,490 more rows</code></pre>
<div class="sourceCode" id="cb338"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 1,500 × 4
##         x       y signx    signy   
##     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
##  1 -0.999  0.251  negative positive
##  2 -0.999 -0.779  negative negative
##  3 -0.999 -0.936  negative negative
##  4 -0.998 -0.0853 negative negative
##  5 -0.998 -0.646  negative negative
##  6 -0.998 -0.921  negative negative
##  7 -0.991  0.808  negative positive
##  8 -0.991  0.805  negative positive
##  9 -0.991  0.0744 negative positive
## 10 -0.988  0.671  negative positive
## # … with 1,490 more rows</code></pre>
</div>
<div id="merge-tables-column-wise" class="section level3" number="6.5.6">
<h3>
<span class="header-section-number">6.5.6</span> Merge tables column-wise<a class="anchor" aria-label="anchor" href="#merge-tables-column-wise"><i class="fas fa-link"></i></a>
</h3>
<p>At least one column with the <strong>exact</strong> same name must be present in each table to use the <code class="sourceCode r"><span class="fu">xx_join</span>()</code> functions. There are more possibilities than <code class="sourceCode r"><span class="fu">inner_join</span>()</code> that I show here, see the help for more information.</p>
<div class="sourceCode" id="cb340"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>signx<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"positive"</span>,<span class="st">"positive"</span>,<span class="st">"negative"</span>,<span class="st">"negative"</span><span class="op">)</span>, 
              signy<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"positive"</span>,<span class="st">"negative"</span>,<span class="st">"positive"</span>,<span class="st">"negative"</span><span class="op">)</span>, 
              value<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="va">dt2</span></code></pre></div>
<pre><code>## # A tibble: 4 × 3
##   signx    signy    value
##   &lt;chr&gt;    &lt;chr&gt;    &lt;lgl&gt;
## 1 positive positive TRUE 
## 2 positive negative FALSE
## 3 negative positive FALSE
## 4 negative negative TRUE</code></pre>
<div class="sourceCode" id="cb342"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">dt</span>, <span class="va">dt2</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 1,500 × 5
##         x       y signx    signy    value
##     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    &lt;lgl&gt;
##  1 -0.430  0.785  negative positive FALSE
##  2  0.417 -0.881  positive negative FALSE
##  3  0.572 -0.0317 positive negative FALSE
##  4 -0.730  0.897  negative positive FALSE
##  5  0.715 -0.598  positive negative FALSE
##  6  0.132  0.0621 positive positive TRUE 
##  7 -0.626  0.119  negative positive FALSE
##  8 -0.828  0.728  negative positive FALSE
##  9 -0.835  0.792  negative positive FALSE
## 10  0.355  0.757  positive positive TRUE 
## # … with 1,490 more rows</code></pre>
</div>
<div id="merge-tables-row-wise" class="section level3" number="6.5.7">
<h3>
<span class="header-section-number">6.5.7</span> Merge tables row-wise<a class="anchor" aria-label="anchor" href="#merge-tables-row-wise"><i class="fas fa-link"></i></a>
</h3>
<p>This works even if there are missing rows.</p>
<div class="sourceCode" id="cb344"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, b<span class="op">=</span><span class="fl">3</span><span class="op">:</span><span class="fl">5</span>, c<span class="op">=</span><span class="fl">6</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span>
<span class="va">dt4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">3</span><span class="op">:</span><span class="fl">1</span>, c<span class="op">=</span><span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>
<span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span><span class="va">dt3</span>, <span class="va">dt4</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##       a     b     c
##   &lt;int&gt; &lt;int&gt; &lt;int&gt;
## 1     1     3     6
## 2     2     4     7
## 3     3     5     8
## 4     3    NA     3
## 5     2    NA     4
## 6     1    NA     5</code></pre>
</div>
<div id="addmodify-a-column" class="section level3" number="6.5.8">
<h3>
<span class="header-section-number">6.5.8</span> Add/modify a column<a class="anchor" aria-label="anchor" href="#addmodify-a-column"><i class="fas fa-link"></i></a>
</h3>
<p><code class="sourceCode r"><span class="fu">mutate</span>()</code>, like <code class="sourceCode r"><span class="sc">$</span></code>, adds a column if it doesn’t exist, and modifies it if it does.</p>
<div class="sourceCode" id="cb346"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>w<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, z<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 1,500 × 6
##         x       y signx    signy        w      z
##     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    &lt;int&gt;  &lt;dbl&gt;
##  1 -0.430  0.785  negative positive     1 -0.417
##  2  0.417 -0.881  positive negative     2  0.405
##  3  0.572 -0.0317 positive negative     3  0.541
##  4 -0.730  0.897  negative positive     4 -0.667
##  5  0.715 -0.598  positive negative     5  0.656
##  6  0.132  0.0621 positive positive     6  0.132
##  7 -0.626  0.119  negative positive     7 -0.586
##  8 -0.828  0.728  negative positive     8 -0.737
##  9 -0.835  0.792  negative positive     9 -0.741
## 10  0.355  0.757  positive positive    10  0.348
## # … with 1,490 more rows</code></pre>
<div class="sourceCode" id="cb348"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 1,500 × 4
##        x       y signx    signy   
##    &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
##  1     1  0.785  negative positive
##  2     2 -0.881  positive negative
##  3     3 -0.0317 positive negative
##  4     4  0.897  negative positive
##  5     5 -0.598  positive negative
##  6     6  0.0621 positive positive
##  7     7  0.119  negative positive
##  8     8  0.728  negative positive
##  9     9  0.792  negative positive
## 10    10  0.757  positive positive
## # … with 1,490 more rows</code></pre>
</div>
<div id="selecting-columns" class="section level3" number="6.5.9">
<h3>
<span class="header-section-number">6.5.9</span> Selecting columns<a class="anchor" aria-label="anchor" href="#selecting-columns"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb350"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>  <span class="co"># only x</span></code></pre></div>
<pre><code>## # A tibble: 1,500 × 1
##         x
##     &lt;dbl&gt;
##  1 -0.430
##  2  0.417
##  3  0.572
##  4 -0.730
##  5  0.715
##  6  0.132
##  7 -0.626
##  8 -0.828
##  9 -0.835
## 10  0.355
## # … with 1,490 more rows</code></pre>
<div class="sourceCode" id="cb352"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="co"># all but x</span></code></pre></div>
<pre><code>## # A tibble: 1,500 × 3
##          y signx    signy   
##      &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
##  1  0.785  negative positive
##  2 -0.881  positive negative
##  3 -0.0317 positive negative
##  4  0.897  negative positive
##  5 -0.598  positive negative
##  6  0.0621 positive positive
##  7  0.119  negative positive
##  8  0.728  negative positive
##  9  0.792  negative positive
## 10  0.757  positive positive
## # … with 1,490 more rows</code></pre>
<div class="sourceCode" id="cb354"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"sign"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 1,500 × 2
##    signx    signy   
##    &lt;chr&gt;    &lt;chr&gt;   
##  1 negative positive
##  2 positive negative
##  3 positive negative
##  4 negative positive
##  5 positive negative
##  6 positive positive
##  7 negative positive
##  8 negative positive
##  9 negative positive
## 10 positive positive
## # … with 1,490 more rows</code></pre>
<div class="sourceCode" id="cb356"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"x"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 1,500 × 2
##         x signx   
##     &lt;dbl&gt; &lt;chr&gt;   
##  1 -0.430 negative
##  2  0.417 positive
##  3  0.572 positive
##  4 -0.730 negative
##  5  0.715 positive
##  6  0.132 positive
##  7 -0.626 negative
##  8 -0.828 negative
##  9 -0.835 negative
## 10  0.355 positive
## # … with 1,490 more rows</code></pre>
</div>
<div id="filtering-columns" class="section level3" number="6.5.10">
<h3>
<span class="header-section-number">6.5.10</span> Filtering columns<a class="anchor" aria-label="anchor" href="#filtering-columns"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb358"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">signx</span><span class="op">==</span><span class="st">"positive"</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 696 × 4
##         x       y signx    signy   
##     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
##  1 0.417  -0.881  positive negative
##  2 0.572  -0.0317 positive negative
##  3 0.715  -0.598  positive negative
##  4 0.132   0.0621 positive positive
##  5 0.355   0.757  positive positive
##  6 0.145   0.444  positive positive
##  7 0.172   0.765  positive positive
##  8 0.627  -0.0858 positive negative
##  9 0.0242  0.643  positive positive
## 10 0.271  -0.787  positive negative
## # … with 686 more rows</code></pre>
<div class="sourceCode" id="cb360"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">x</span><span class="op">&lt;</span><span class="fl">0</span>, <span class="va">y</span><span class="op">&gt;</span><span class="fl">.1</span><span class="op">)</span> <span class="co"># multiple filters can be applied at once</span></code></pre></div>
<pre><code>## # A tibble: 345 × 4
##         x     y signx    signy   
##     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
##  1 -0.430 0.785 negative positive
##  2 -0.730 0.897 negative positive
##  3 -0.626 0.119 negative positive
##  4 -0.828 0.728 negative positive
##  5 -0.835 0.792 negative positive
##  6 -0.825 0.742 negative positive
##  7 -0.215 0.376 negative positive
##  8 -0.713 0.925 negative positive
##  9 -0.228 0.360 negative positive
## 10 -0.717 0.689 negative positive
## # … with 335 more rows</code></pre>
</div>
<div id="reorder-columns" class="section level3" number="6.5.11">
<h3>
<span class="header-section-number">6.5.11</span> Reorder columns<a class="anchor" aria-label="anchor" href="#reorder-columns"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb362"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="va">signy</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 1,500 × 4
##         x signx    signy          y
##     &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt;
##  1 -0.430 negative positive  0.785 
##  2  0.417 positive negative -0.881 
##  3  0.572 positive negative -0.0317
##  4 -0.730 negative positive  0.897 
##  5  0.715 positive negative -0.598 
##  6  0.132 positive positive  0.0621
##  7 -0.626 negative positive  0.119 
##  8 -0.828 negative positive  0.728 
##  9 -0.835 negative positive  0.792 
## 10  0.355 positive positive  0.757 
## # … with 1,490 more rows</code></pre>
</div>
<div id="separate-columns" class="section level3" number="6.5.12">
<h3>
<span class="header-section-number">6.5.12</span> Separate columns<a class="anchor" aria-label="anchor" href="#separate-columns"><i class="fas fa-link"></i></a>
</h3>
<p>The separation is based on standard separators such as “-”, “_”, “.”, " ", etc. A single separator can be specified with the argument <code>sep</code>, otherwise all separators are used. One must provide the resulting vector of new column names: if one value is <code class="sourceCode r"><span class="cn">NA</span></code>, this column will be discarded. Examples:</p>
<div class="sourceCode" id="cb364"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="st">"Exo/FTIR/Data/"</span>, pattern<span class="op">=</span><span class="st">".xls"</span><span class="op">)</span><span class="op">)</span>
<span class="va">dt5</span></code></pre></div>
<pre><code>## # A tibble: 10 × 1
##    file             
##    &lt;chr&gt;            
##  1 sample_0_25C.xls 
##  2 sample_0_300C.xls
##  3 sample_1_25C.xls 
##  4 sample_1_300C.xls
##  5 sample_2_25C.xls 
##  6 sample_2_300C.xls
##  7 sample_3_25C.xls 
##  8 sample_3_300C.xls
##  9 sample_4_25C.xls 
## 10 sample_4_300C.xls</code></pre>
<div class="sourceCode" id="cb366"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt5</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html">separate</a></span><span class="op">(</span><span class="va">file</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="st">"sample"</span>, <span class="st">"temperature"</span>, <span class="cn">NA</span><span class="op">)</span>, convert <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 2
##    sample temperature
##     &lt;int&gt; &lt;chr&gt;      
##  1      0 25C        
##  2      0 300C       
##  3      1 25C        
##  4      1 300C       
##  5      2 25C        
##  6      2 300C       
##  7      3 25C        
##  8      3 300C       
##  9      4 25C        
## 10      4 300C</code></pre>
<div class="sourceCode" id="cb368"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt5</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html">separate</a></span><span class="op">(</span><span class="va">file</span>, 
                 <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"name"</span>, <span class="st">"extension"</span><span class="op">)</span>, 
                 sep <span class="op">=</span> <span class="st">"\\."</span>
                 <span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 2
##    name          extension
##    &lt;chr&gt;         &lt;chr&gt;    
##  1 sample_0_25C  xls      
##  2 sample_0_300C xls      
##  3 sample_1_25C  xls      
##  4 sample_1_300C xls      
##  5 sample_2_25C  xls      
##  6 sample_2_300C xls      
##  7 sample_3_25C  xls      
##  8 sample_3_300C xls      
##  9 sample_4_25C  xls      
## 10 sample_4_300C xls</code></pre>
</div>
<div id="apply-a-function-recursively-on-each-element-of-a-column" class="section level3" number="6.5.13">
<h3>
<span class="header-section-number">6.5.13</span> Apply a function recursively on each element of a column<a class="anchor" aria-label="anchor" href="#apply-a-function-recursively-on-each-element-of-a-column"><i class="fas fa-link"></i></a>
</h3>
<p>Take a look at the <a href="https://github.com/rstudio/cheatsheets/raw/master/purrr.pdf">cheatsheet on the <code>purrr</code> package</a> for more options. I show here a use of <code class="sourceCode r">purrr<span class="sc">::</span><span class="fu">map</span>(vector, <span class="cf">function</span>)</code> that returns a list. <code class="sourceCode r"><span class="fu">map</span>(x, f)</code> applies the function <code>f()</code> to each element of the vector <code>x</code>, putting the result in a separate element of a list: <code class="sourceCode r"><span class="fu">map</span>(x, f) <span class="ot">-&gt;</span> <span class="fu">list</span>(<span class="fu">f</span>(x1), <span class="fu">f</span>(x2), ... <span class="fu">f</span>(xn))</code>. In case <code>f(xi)</code> returns a single value, you might want to use <code><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl()</a></code> or <code><a href="https://purrr.tidyverse.org/reference/map.html">map_chr()</a></code>, for example, that will return a vector of doubles or of characters, respectively.</p>
<div class="sourceCode" id="cb370"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">pi</span>, <span class="va">pi</span><span class="op">/</span><span class="fl">3</span>, <span class="va">pi</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">sin</span><span class="op">)</span>     <span class="co"># returns a list</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1.224647e-16
## 
## [[2]]
## [1] 0.8660254
## 
## [[3]]
## [1] 1</code></pre>
<div class="sourceCode" id="cb372"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl</a></span><span class="op">(</span><span class="va">sin</span><span class="op">)</span> <span class="co"># returns a vector</span></code></pre></div>
<pre><code>## [1] 1.224647e-16 8.660254e-01 1.000000e+00</code></pre>
<p>Of course, in the above case, it’s a stupid use of the power of <code class="sourceCode r"><span class="fu">map</span>()</code>. A typical use case is when you want to read multiple files, for example:</p>
<div class="sourceCode" id="cb374"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="st">"Exo/spectro/Data"</span>, 
                              pattern <span class="op">=</span> <span class="st">".txt"</span>, 
                              full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">file</span>, <span class="va">read_table</span><span class="op">)</span><span class="op">)</span>
<span class="va">dt6</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##   file                          data                     
##   &lt;chr&gt;                         &lt;list&gt;                   
## 1 Exo/spectro/Data/rubis_01.txt &lt;spec_tbl_df [1,014 × 2]&gt;
## 2 Exo/spectro/Data/rubis_02.txt &lt;spec_tbl_df [1,014 × 2]&gt;
## 3 Exo/spectro/Data/rubis_03.txt &lt;spec_tbl_df [1,014 × 2]&gt;
## 4 Exo/spectro/Data/rubis_04.txt &lt;spec_tbl_df [1,014 × 2]&gt;
## 5 Exo/spectro/Data/rubis_05.txt &lt;spec_tbl_df [1,014 × 2]&gt;</code></pre>
<p>This is (almost) equivalent to:</p>
<div class="sourceCode" id="cb376"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="st">"Exo/spectro/Data"</span>, 
                              pattern <span class="op">=</span> <span class="st">".txt"</span>, 
                              full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">file</span>, <span class="op">~</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_table.html">read_table</a></span><span class="op">(</span><span class="va">.</span>, col_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"w"</span>, <span class="st">"Int"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>You see that you can create the function directly within the call to map using the shortcut <code class="sourceCode r"><span class="fu">map</span>(vector, <span class="sc">~</span> <span class="cf">function</span>(.))</code>. This is useful to provide more arguments to the function – another solution is to write your own function before the call to <code class="sourceCode r"><span class="fu">map</span>()</code> and then call this function in <code class="sourceCode r"><span class="fu">map</span>()</code>.</p>
<p>Note that in case you need more parameters, you can use <code class="sourceCode r">purrr<span class="sc">::</span><span class="fu">map2</span>(vector1, vector2, <span class="sc">~</span><span class="cf">function</span>(.x, .y))</code>, where <code>.x</code> and <code>.y</code> refer to <code>vector1</code> and <code>vector2</code>, respectively (it’s always <code>.x</code> and <code>.y</code> whatever the name of <code>vector1</code> and <code>vector2</code>).</p>
<div class="sourceCode" id="cb377"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, y<span class="op">=</span><span class="fl">5</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>sum <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">map2_dbl</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">sum</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##       x     y   sum
##   &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
## 1     1     5     6
## 2     2     6     8
## 3     3     7    10</code></pre>
<div class="sourceCode" id="cb379"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>a<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, y<span class="op">=</span><span class="fl">5</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span>, 
              <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">0</span><span class="op">:</span><span class="fl">3</span>, y<span class="op">=</span><span class="fl">4</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span><span class="op">)</span>, 
       b<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">10</span><span class="op">:</span><span class="fl">13</span>, y<span class="op">=</span><span class="fl">15</span><span class="op">:</span><span class="fl">18</span><span class="op">)</span>, 
              <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x<span class="op">=</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,  y<span class="op">=</span><span class="op">-</span><span class="fl">14</span><span class="op">:</span><span class="op">-</span><span class="fl">17</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>sumx <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">map2_dbl</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">.x</span><span class="op">$</span><span class="va">x</span>, <span class="va">.y</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,
           sumy <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">map2_dbl</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">.x</span><span class="op">$</span><span class="va">y</span>, <span class="va">.y</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 4
##   a                b                 sumx  sumy
##   &lt;list&gt;           &lt;list&gt;           &lt;dbl&gt; &lt;dbl&gt;
## 1 &lt;tibble [3 × 2]&gt; &lt;tibble [4 × 2]&gt;    52    84
## 2 &lt;tibble [4 × 2]&gt; &lt;tibble [4 × 2]&gt;     8   -40</code></pre>
</div>
<div id="nesting-and-un-nesting-data" class="section level3" number="6.5.14">
<h3>
<span class="header-section-number">6.5.14</span> Nesting and un-nesting data<a class="anchor" aria-label="anchor" href="#nesting-and-un-nesting-data"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb381"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt7</span> <span class="op">&lt;-</span> <span class="va">dt6</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html">basename</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>
<span class="va">dt7</span></code></pre></div>
<pre><code>## # A tibble: 5,075 × 3
##    file             w   Int
##    &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;
##  1 rubis_01.txt 3064.  43.9
##  2 rubis_01.txt 3064.  47.9
##  3 rubis_01.txt 3064.  44.5
##  4 rubis_01.txt 3065.  50.5
##  5 rubis_01.txt 3065.  50.5
##  6 rubis_01.txt 3065.  44.5
##  7 rubis_01.txt 3065.  44.9
##  8 rubis_01.txt 3066.  39.9
##  9 rubis_01.txt 3066.  49.5
## 10 rubis_01.txt 3066.  48.9
## # … with 5,065 more rows</code></pre>
<div class="sourceCode" id="cb383"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Nesting data per repeated values in a column (~equivalent to grouping)</span>
<span class="va">dt7</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">nest</a></span><span class="op">(</span>data<span class="op">=</span><span class="op">-</span><span class="va">file</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##   file         data                
##   &lt;chr&gt;        &lt;list&gt;              
## 1 rubis_01.txt &lt;tibble [1,015 × 2]&gt;
## 2 rubis_02.txt &lt;tibble [1,015 × 2]&gt;
## 3 rubis_03.txt &lt;tibble [1,015 × 2]&gt;
## 4 rubis_04.txt &lt;tibble [1,015 × 2]&gt;
## 5 rubis_05.txt &lt;tibble [1,015 × 2]&gt;</code></pre>
</div>
<div id="providing-data-to-ggplot" class="section level3" number="6.5.15">
<h3>
<span class="header-section-number">6.5.15</span> Providing data to ggplot<a class="anchor" aria-label="anchor" href="#providing-data-to-ggplot"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb385"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">&gt;</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, color<span class="op">=</span><span class="va">signy</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-128-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="exo-df" class="section level2" number="6.6">
<h2>
<span class="header-section-number">6.6</span> Exercises<a class="anchor" aria-label="anchor" href="#exo-df"><i class="fas fa-link"></i></a>
</h2>
<p>Interactive exercises can be found in the <a href="https://lmi.cnrs.fr/r/tutor/"><code>tutor</code></a> package. For this, simply run:</p>
<div class="sourceCode" id="cb386"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">tutor</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/tutor/man/tuto.html">tuto</a></span><span class="op">(</span><span class="st">"dataframes"</span><span class="op">)</span></code></pre></div>
<hr>
<details><summary><strong>Exercise 1</strong>
</summary><ul>
<li>Create a 3 column <code class="sourceCode r">data.frame</code> containing 10 random values, their sinus, and the sum of the two first columns.</li>
<li>Print the 4 first lines of the table</li>
<li>Print the second column</li>
<li>Print the average of the third column</li>
<li>Using <code class="sourceCode r"><span class="fu">plot</span>(x,y)</code> where <code>x</code> and <code>y</code> are vectors, plot the 2nd column as a function of the first</li>
<li>Look into the function <code class="sourceCode r"><span class="fu">write.table</span>()</code> to write a text file containing this <code class="sourceCode r">data.frame</code>
</li>
<li>Do the all the same things with a <code class="sourceCode r">tibble</code>
</li>
</ul>
<details><summary>
Solution
</summary><div class="sourceCode" id="cb387"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create a 3 column `data.frame`{.R} containing 10 random values, their sinus, </span>
<span class="co"># and the sum of the two first columns.</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="va">z</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">+</span> <span class="va">y</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, z<span class="op">=</span><span class="va">z</span><span class="op">)</span>
<span class="co"># Print the 4 first lines of the table</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">4</span><span class="op">)</span></code></pre></div>
<pre><code>##            x          y          z
## 1 0.03527932 0.03527201 0.07055133
## 2 0.60510844 0.56885127 1.17395971
## 3 0.02472849 0.02472597 0.04945446
## 4 0.47338596 0.45590249 0.92928845</code></pre>
<div class="sourceCode" id="cb389"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Print the second column</span>
<span class="va">df</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></code></pre></div>
<pre><code>##  [1] 0.03527201 0.56885127 0.02472597 0.45590249 0.26549129 0.44572934
##  [7] 0.49928664 0.21686341 0.34470148 0.33159557</code></pre>
<div class="sourceCode" id="cb391"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Print the average of the third column</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">z</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.6488915</code></pre>
<pre><code>## Warning in mean.default(df[3]): argument is not numeric or logical: returning NA</code></pre>
<pre><code>## [1] NA</code></pre>
<pre><code>## [1] 0.6488915</code></pre>
<div class="sourceCode" id="cb396"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Using `plot(x,y)`{.R} where `x` and `y` are vectors, </span>
<span class="co"># plot the 2nd column as a function of the first</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">df</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-129-1.png" width="100%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb397"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">x</span>, <span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-129-2.png" width="100%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb398"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Look into the function `write.table()`{.R} to write a text file </span>
<span class="co"># containing this `data.frame`{.R}</span>
<span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.table</a></span><span class="op">(</span><span class="va">df</span>, <span class="st">"Data/some_data.dat"</span>, quote <span class="op">=</span> <span class="cn">FALSE</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co"># # # # # # # # # # # # # # # # # </span>
<span class="co"># Tibble version</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="va">df_tib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>, c <span class="op">=</span> <span class="va">a</span> <span class="op">+</span> <span class="va">b</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df_tib</span>, <span class="fl">4</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 3
##       a     b     c
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 0.207 0.205 0.412
## 2 0.115 0.115 0.230
## 3 0.426 0.413 0.839
## 4 0.141 0.140 0.281</code></pre>
<div class="sourceCode" id="cb400"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_tib</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>; <span class="va">df_tib</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>;</code></pre></div>
<pre><code>## # A tibble: 10 × 1
##        b
##    &lt;dbl&gt;
##  1 0.205
##  2 0.115
##  3 0.413
##  4 0.140
##  5 0.506
##  6 0.559
##  7 0.716
##  8 0.585
##  9 0.373
## 10 0.181</code></pre>
<pre><code>##  [1] 0.2053041 0.1146277 0.4133594 0.1403453 0.5056044 0.5590776 0.7161695
##  [8] 0.5845324 0.3727067 0.1813079</code></pre>
<div class="sourceCode" id="cb403"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df_tib</span><span class="op">$</span><span class="va">c</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df_tib</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df_tib</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df_tib</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.7791838</code></pre>
<pre><code>## Warning in mean.default(df_tib[3]): argument is not numeric or logical:
## returning NA</code></pre>
<pre><code>## [1] NA</code></pre>
<pre><code>## Warning in mean.default(df_tib[, 3]): argument is not numeric or logical:
## returning NA</code></pre>
<pre><code>## [1] NA</code></pre>
<pre><code>## [1] 0.7791838</code></pre>
<div class="sourceCode" id="cb410"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.table</a></span><span class="op">(</span><span class="va">df_tib</span>, <span class="st">"Data/some_data.dat"</span>, quote <span class="op">=</span> <span class="cn">FALSE</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">df_tib</span><span class="op">$</span><span class="va">a</span>, <span class="va">df_tib</span><span class="op">$</span><span class="va">b</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-129-3.png" width="100%" style="display: block; margin: auto;"></div>
</details></details><details><summary><strong>Exercise 2</strong>
</summary><ul>
<li>Download the files:
<ul>
<li><a href="Data/rubis_01.txt" download target="_blank">rubis_01.txt</a></li>
<li><a href="Data/population.csv" download target="_blank">population.csv</a></li>
<li><a href="Data/FTIR_rocks.xlsx" download target="_blank">FTIR_rocks.xlsx</a></li>
</ul>
</li>
<li>Load them into separate <code class="sourceCode r">data.frames</code>. Look into the options of <code class="sourceCode r"><span class="fu">read.table</span>()</code>, <code class="sourceCode r"><span class="fu">read.csv</span>()</code>, <code class="sourceCode r">readxl<span class="sc">::</span><span class="fu">read_excel</span>()</code>, to get the proper data fields.</li>
<li>Add column names to the data.frame containing <code>rubis_01.txt</code>.</li>
<li>Print their dimensions.</li>
<li>Do the same things with tibbles.</li>
</ul>
<details><summary>
Solution
</summary><div class="sourceCode" id="cb411"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rubis_01</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"Data/rubis_01.txt"</span>, col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"w"</span>, <span class="st">"intensity"</span><span class="op">)</span><span class="op">)</span>
<span class="va">population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"Data/population.csv"</span><span class="op">)</span>
<span class="va">FTIR_rocks</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"Data/FTIR_rocks.xlsx"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">rubis_01</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">rubis_01</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1015    2</code></pre>
<pre><code>## [1] "w"         "intensity"</code></pre>
<div class="sourceCode" id="cb414"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">population</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">population</span><span class="op">)</span></code></pre></div>
<pre><code>## [1]  8 21</code></pre>
<pre><code>##  [1] "year"          "Angers"        "Bordeaux"      "Brest"        
##  [5] "Dijon"         "Grenoble"      "LeHavre"       "LeMans"       
##  [9] "Lille"         "Lyon"          "Marseille"     "Montpellier"  
## [13] "Nantes"        "Nice"          "Paris"         "Reims"        
## [17] "Rennes"        "Saint.Etienne" "Strasbourg"    "Toulon"       
## [21] "Toulouse"</code></pre>
<div class="sourceCode" id="cb417"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">FTIR_rocks</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">FTIR_rocks</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 4718    4</code></pre>
<pre><code>## [1] "wavenumber, cm-1" "rock 1"           "rock 2"           "rock 3"</code></pre>
<div class="sourceCode" id="cb420"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="va">rubis_01</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_table.html">read_table</a></span><span class="op">(</span><span class="st">"Data/rubis_01.txt"</span>, col_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"w"</span>, <span class="st">"intensity"</span><span class="op">)</span><span class="op">)</span>
<span class="va">population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"Data/population.csv"</span><span class="op">)</span></code></pre></div>
</details></details><details><summary><strong>Exercise 3</strong>
</summary><ul>
<li>Download the TGA data file <a href="Data/ATG.txt" download target="_blank">ATG.txt</a>
</li>
<li>Load it into a <code class="sourceCode r">data.frame</code>. Look into the options of <code class="sourceCode r"><span class="fu">read.table</span>()</code> to get the proper data fields.</li>
<li>Do the same with a tibble</li>
</ul>
<details><summary>
Solution
</summary><div class="sourceCode" id="cb421"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"Data/ATG.txt"</span>, 
                skip<span class="op">=</span><span class="fl">12</span>,
                header<span class="op">=</span><span class="cn">FALSE</span>, 
                nrows<span class="op">=</span><span class="fl">4088</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Index"</span>, <span class="st">"t"</span>, <span class="st">"Ts"</span>, <span class="st">"Tr"</span>, <span class="st">"Value"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></code></pre></div>
<pre><code>##   Index  t      Ts Tr   Value
## 1     0  0 32.3769 25 32.9680
## 2     3  3 32.4051 25 32.9655
## 3     6  6 32.4332 25 32.9619
## 4     9  9 32.4726 25 32.9582
## 5    12 12 32.5066 25 32.9544
## 6    15 15 32.5221 25 32.9504</code></pre>
<div class="sourceCode" id="cb423"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"Data/ATG.txt"</span>, 
                skip<span class="op">=</span><span class="fl">10</span>,
                comment.char<span class="op">=</span><span class="st">"["</span>,
                header<span class="op">=</span><span class="cn">TRUE</span>, 
                nrows<span class="op">=</span><span class="fl">4088</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></code></pre></div>
<pre><code>##   Index  t      Ts Tr   Value
## 1     0  0 32.3769 25 32.9680
## 2     3  3 32.4051 25 32.9655
## 3     6  6 32.4332 25 32.9619
## 4     9  9 32.4726 25 32.9582
## 5    12 12 32.5066 25 32.9544
## 6    15 15 32.5221 25 32.9504</code></pre>
<div class="sourceCode" id="cb425"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_table.html">read_table</a></span><span class="op">(</span><span class="st">"Data/ATG.txt"</span>, 
                skip    <span class="op">=</span> <span class="fl">10</span>,
                comment <span class="op">=</span> <span class="st">"["</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
        <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: 122 parsing failures.
##  row   col  expected    actual           file
##   NA NA    5 columns 0 columns 'Data/ATG.txt'
## 4090 Index a double  Results:  'Data/ATG.txt'
## 4090 NA    5 columns 1 columns 'Data/ATG.txt'
## 4091 Index a double  Content   'Data/ATG.txt'
## 4091 Ts    a double  %         'Data/ATG.txt'
## .... ..... ......... ......... ..............
## See problems(...) for more details.</code></pre>
<div class="sourceCode" id="cb427"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d</span></code></pre></div>
<pre><code>## # A tibble: 4,088 × 5
##    Index     t    Ts    Tr Value
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1     0     0  32.4    25  33.0
##  2     3     3  32.4    25  33.0
##  3     6     6  32.4    25  33.0
##  4     9     9  32.5    25  33.0
##  5    12    12  32.5    25  33.0
##  6    15    15  32.5    25  33.0
##  7    18    18  32.6    25  32.9
##  8    21    21  32.6    25  32.9
##  9    24    24  32.6    25  32.9
## 10    27    27  32.7    25  32.9
## # … with 4,078 more rows</code></pre>
</details></details><details><summary><strong>Exercise 4</strong>
</summary><p>Download <a href="Data/population.csv" download target="_blank">population.csv</a> and load it into a <code class="sourceCode r">tibble</code>.</p>
<ul>
<li>What are the names of the columns?</li>
<li>Are the data tidy? make the table tidy if needed</li>
<li>Create a subset containing the data for Montpellier
<ul>
<li>What is the max and min of population in this city?</li>
<li>The average population over time?</li>
</ul>
</li>
<li>What is the total population in 2012?</li>
<li>What is the total population per year?</li>
<li>What is the average population per city over the years?</li>
</ul>
<details><summary>
Solution
</summary><div class="sourceCode" id="cb429"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Download population.txt and load it into a `data.frame`{.R}.</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="va">popul</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"Data/population.csv"</span><span class="op">)</span>
<span class="co"># What are the names of the columns and the dimension of the table?</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">popul</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">popul</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] "year"          "Angers"        "Bordeaux"      "Brest"        
##  [5] "Dijon"         "Grenoble"      "LeHavre"       "LeMans"       
##  [9] "Lille"         "Lyon"          "Marseille"     "Montpellier"  
## [13] "Nantes"        "Nice"          "Paris"         "Reims"        
## [17] "Rennes"        "Saint-Etienne" "Strasbourg"    "Toulon"       
## [21] "Toulouse"</code></pre>
<pre><code>## [1]  8 21</code></pre>
<div class="sourceCode" id="cb432"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Are the data tidy?</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">popul</span><span class="op">)</span> <span class="co"># no</span></code></pre></div>
<pre><code>## # A tibble: 6 × 21
##    year Angers Bordeaux  Brest  Dijon Grenoble LeHavre LeMans  Lille   Lyon
##   &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1  1962 115273   278403 136104 135694   156707  187845 132181 239955 535746
## 2  1968 128557   266662 154023 145357   161616  207150 143246 238554 527800
## 3  1975 137591   223131 166826 151705   166037  217882 152285 219204 456716
## 4  1982 136038   208159 156060 140942   156637  199388 147697 196705 413095
## 5  1990 141404   210336 147956 146703   150758  195854 145502 198691 415487
## 6  1999 151279   215363 149634 149867   153317  190905 146105 212597 445452
## # … with 11 more variables: Marseille &lt;dbl&gt;, Montpellier &lt;dbl&gt;, Nantes &lt;dbl&gt;,
## #   Nice &lt;dbl&gt;, Paris &lt;dbl&gt;, Reims &lt;dbl&gt;, Rennes &lt;dbl&gt;, `Saint-Etienne` &lt;dbl&gt;,
## #   Strasbourg &lt;dbl&gt;, Toulon &lt;dbl&gt;, Toulouse &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb434"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">popul.tidy</span> <span class="op">&lt;-</span> <span class="va">popul</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols<span class="op">=</span><span class="op">-</span><span class="va">year</span>,
                 names_to <span class="op">=</span> <span class="st">"city"</span>,
                 values_to <span class="op">=</span> <span class="st">"pop"</span>
                <span class="op">)</span>
<span class="va">popul.tidy</span></code></pre></div>
<pre><code>## # A tibble: 160 × 3
##     year city         pop
##    &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;
##  1  1962 Angers    115273
##  2  1962 Bordeaux  278403
##  3  1962 Brest     136104
##  4  1962 Dijon     135694
##  5  1962 Grenoble  156707
##  6  1962 LeHavre   187845
##  7  1962 LeMans    132181
##  8  1962 Lille     239955
##  9  1962 Lyon      535746
## 10  1962 Marseille 778071
## # … with 150 more rows</code></pre>
<div class="sourceCode" id="cb436"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create a subset containing the data for Montpellier</span>
<span class="va">mtp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">popul.tidy</span>, <span class="va">city</span> <span class="op">==</span> <span class="st">"Montpellier"</span><span class="op">)</span>
<span class="co"># I prefer the tidyverse version</span>
<span class="va">mtp</span> <span class="op">&lt;-</span> <span class="va">popul.tidy</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">city</span> <span class="op">==</span> <span class="st">"Montpellier"</span><span class="op">)</span>
<span class="co"># What is the max and min of population in this city?</span>
<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">mtp</span><span class="op">$</span><span class="va">pop</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 268456</code></pre>
<div class="sourceCode" id="cb438"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">mtp</span><span class="op">$</span><span class="va">pop</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 118864</code></pre>
<div class="sourceCode" id="cb440"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">mtp</span><span class="op">$</span><span class="va">pop</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 118864 268456</code></pre>
<div class="sourceCode" id="cb442"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The average population over time?</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">mtp</span><span class="op">$</span><span class="va">pop</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 203114.4</code></pre>
<div class="sourceCode" id="cb444"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># What is the total population in 2012?</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">popul.tidy</span><span class="op">[</span><span class="va">popul.tidy</span><span class="op">$</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2012</span>, <span class="st">"pop"</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 7334805</code></pre>
<div class="sourceCode" id="cb446"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">popul.tidy</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span><span class="op">==</span><span class="fl">2012</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 7334805</code></pre>
<div class="sourceCode" id="cb448"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># What is the total population per year?</span>
<span class="va">popul.tidy</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>pop_tot<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 8 × 2
##    year pop_tot
##   &lt;dbl&gt;   &lt;dbl&gt;
## 1  1962 7349547
## 2  1968 7550999
## 3  1975 7298183
## 4  1982 6933230
## 5  1990 6857291
## 6  1999 6965325
## 7  2007 7235114
## 8  2012 7334805</code></pre>
<div class="sourceCode" id="cb450"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># What is the average population per city over the years?</span>
<span class="va">popul.tidy</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">city</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>pop_ave<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 20 × 2
##    city           pop_ave
##    &lt;chr&gt;            &lt;dbl&gt;
##  1 Angers         138783.
##  2 Bordeaux       234815.
##  3 Brest          149125.
##  4 Dijon          146735.
##  5 Grenoble       157526.
##  6 LeHavre        193990.
##  7 LeMans         144347.
##  8 Lille          220018.
##  9 Lyon           470371.
## 10 Marseille      844253.
## 11 Montpellier    203114.
## 12 Nantes         260925.
## 13 Nice           334312.
## 14 Paris         2321032.
## 15 Reims          172278 
## 16 Rennes         193425.
## 17 Saint-Etienne  198135.
## 18 Strasbourg     255429.
## 19 Toulon         169683.
## 20 Toulouse       382265.</code></pre>
</details></details><details><summary><strong>Exercise 5</strong>
</summary><ul>
<li>First, load the <code>tidyverse</code> and <code>lubridate</code> package</li>
<li>Load <a href="Data/people1.csv" download target="_blank">people1.csv</a> and <a href="Data/people2.csv" download target="_blank">people2.csv</a> into <code>pp1</code> and <code>pp2</code>
</li>
<li>Create a new tibble <code>pp</code> by using the pipe operator (<code class="sourceCode r"><span class="sc">%&gt;%</span></code>) and successively:
<ul>
<li>joining the two tibbles into one using <code class="sourceCode r"><span class="fu">inner_join</span>()</code>
</li>
<li>adding a column <code>age</code> containing the age in years (use <code class="sourceCode r">lubridate<span class="sc">::</span><span class="fu">time_length</span>(x, <span class="st">'years'</span>)</code> with x a time difference in days) by using <code class="sourceCode r"><span class="fu">mutate</span>()</code>
</li>
</ul>
</li>
<li>Display a summary of the table using <code class="sourceCode r"><span class="fu">str</span>()</code>
</li>
<li>Using <code class="sourceCode r"><span class="fu">groupe_by</span>()</code> and <code class="sourceCode r"><span class="fu">summarize</span>()</code>:
<ul>
<li>Show the number of males and females in the table (use the counter <code class="sourceCode r"><span class="fu">n</span>()</code>)</li>
<li>Show the average age per gender</li>
<li>Show the average size per gender and institution</li>
<li>Show the number of people from each country, sorted by descending population (<code class="sourceCode r"><span class="fu">arrange</span>()</code>)</li>
</ul>
</li>
<li>Using <code class="sourceCode r"><span class="fu">select</span>()</code>, display:
<ul>
<li>only the name and age columns</li>
<li>all but the name column</li>
</ul>
</li>
<li>Using <code class="sourceCode r"><span class="fu">filter</span>()</code>, show data only for
<ul>
<li>Chinese people</li>
<li>From institution ECL and UCBL</li>
<li>People older than 22</li>
<li>People with a <code>e</code> in their name</li>
</ul>
</li>
</ul>
<details><summary>
Solution
</summary><div class="sourceCode" id="cb452"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># First, load the `tidyverse` and `lubridate` package</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span>
<span class="co"># Load people1.csv and people2.csv</span>
<span class="va">pp1</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"Data/people1.csv"</span><span class="op">)</span>
<span class="va">pp2</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"Data/people2.csv"</span><span class="op">)</span>
<span class="co"># Create a new tibble `pp` by using the pipe operator (`%&gt;%`)</span>
<span class="co"># and successively:</span>
<span class="co"># - joining the two tibbles into one using `inner_join()`</span>
<span class="co"># - adding a column `age` containing the age in years </span>
<span class="co">#   (use lubridate's `time_length(x, 'years')` with x a time</span>
<span class="co">#   difference in days) by using `mutate()`</span>
<span class="va">pp</span> <span class="op">&lt;-</span> <span class="va">pp1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">pp2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>age<span class="op">=</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/time_length.html">time_length</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/now.html">today</a></span><span class="op">(</span><span class="op">)</span><span class="op">-</span><span class="va">dateofbirth</span>,<span class="st">'years'</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Display a summary of the table using `str()`</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">pp</span><span class="op">)</span></code></pre></div>
<pre><code>## tibble [20 × 7] (S3: tbl_df/tbl/data.frame)
##  $ name       : chr [1:20] "Salem" "Dilruwan-Shanaka-Perera" "Hanna" "Sabin" ...
##  $ gender     : chr [1:20] "Male" "Male" "Female" "Male" ...
##  $ origin     : chr [1:20] "Yemen" "Sri Lanka" "Ukraine" "India" ...
##  $ institution: chr [1:20] "UCBL" "INSA" "ECL" "INSA" ...
##  $ dateofbirth: Date[1:20], format: "1997-12-26" "1997-03-28" ...
##  $ size       : num [1:20] 161 172 165 186 176 ...
##  $ age        : num [1:20] 24.3 25 24.3 26.7 27 ...</code></pre>
<div class="sourceCode" id="cb454"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Using `groupe_by()` and `summarize()`:</span>
<span class="co"># - Show the number of males and females in the table </span>
<span class="co">#   (use the counter `n()`)</span>
<span class="va">pp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">gender</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>count<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 2
##   gender count
##   &lt;chr&gt;  &lt;int&gt;
## 1 Female     4
## 2 Male      16</code></pre>
<div class="sourceCode" id="cb456"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># - Show the average age per gender</span>
<span class="va">pp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">gender</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>age<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 2
##   gender   age
##   &lt;chr&gt;  &lt;dbl&gt;
## 1 Female  26.3
## 2 Male    26.0</code></pre>
<div class="sourceCode" id="cb458"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># - Show the average size per gender and institution</span>
<span class="va">pp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">gender</span>, <span class="va">institution</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>size<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 3
## # Groups:   gender [2]
##   gender institution  size
##   &lt;chr&gt;  &lt;chr&gt;       &lt;dbl&gt;
## 1 Female ECL          178.
## 2 Male   ECL          168.
## 3 Male   INSA         174.
## 4 Male   UCBL         174.</code></pre>
<div class="sourceCode" id="cb460"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># - Show the number of people from each country, </span>
<span class="co">#   sorted by descending population</span>
<span class="va">pp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">origin</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>count<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 13 × 2
##    origin      count
##    &lt;chr&gt;       &lt;int&gt;
##  1 China           4
##  2 Ukraine         4
##  3 USA             2
##  4 Afghanistan     1
##  5 Austria         1
##  6 Brazil          1
##  7 Colombia        1
##  8 Cyprus          1
##  9 India           1
## 10 Iran            1
## 11 Sri Lanka       1
## 12 Tunisia         1
## 13 Yemen           1</code></pre>
<div class="sourceCode" id="cb462"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Using `select()`, display:</span>
<span class="co"># - only the name and age columns</span>
<span class="va">pp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">age</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 20 × 2
##    name                      age
##    &lt;chr&gt;                   &lt;dbl&gt;
##  1 Salem                    24.3
##  2 Dilruwan-Shanaka-Perera  25.0
##  3 Hanna                    24.3
##  4 Sabin                    26.7
##  5 Benedikt                 27.0
##  6 Jordyn                   25.1
##  7 Jennifer                 26.9
##  8 Yiran                    27.2
##  9 Leran                    29.3
## 10 Aymen                    32.1
## 11 Pavlo                    25.0
## 12 Saulo                    27.5
## 13 Nicolas-Estevan          28.4
## 14 Farzad                   25.3
## 15 Roein                    22.7
## 16 Paraskevas               22.8
## 17 Ihor                     22.5
## 18 Iryna                    29.1
## 19 Peng                     25.3
## 20 Mingyuan                 24.6</code></pre>
<div class="sourceCode" id="cb464"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># - all but the name column</span>
<span class="va">pp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">name</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 20 × 6
##    gender origin      institution dateofbirth  size   age
##    &lt;chr&gt;  &lt;chr&gt;       &lt;chr&gt;       &lt;date&gt;      &lt;dbl&gt; &lt;dbl&gt;
##  1 Male   Yemen       UCBL        1997-12-26   161.  24.3
##  2 Male   Sri Lanka   INSA        1997-03-28   172.  25.0
##  3 Female Ukraine     ECL         1997-12-30   165.  24.3
##  4 Male   India       INSA        1995-08-04   186.  26.7
##  5 Male   Austria     UCBL        1995-04-25   176.  27.0
##  6 Female USA         ECL         1997-02-19   176.  25.1
##  7 Female USA         ECL         1995-05-28   179   26.9
##  8 Male   China       UCBL        1995-02-04   188.  27.2
##  9 Male   China       UCBL        1992-12-30   186   29.3
## 10 Male   Tunisia     INSA        1990-03-03   160.  32.1
## 11 Male   Ukraine     ECL         1997-04-12   151.  25.0
## 12 Male   Brazil      ECL         1994-09-24   184.  27.5
## 13 Male   Colombia    INSA        1993-11-25   184.  28.4
## 14 Male   Iran        INSA        1996-12-27   183   25.3
## 15 Male   Afghanistan INSA        1999-07-11   155.  22.7
## 16 Male   Cyprus      INSA        1999-06-25   176.  22.8
## 17 Male   Ukraine     ECL         1999-10-03   170.  22.5
## 18 Female Ukraine     ECL         1993-02-27   192   29.1
## 19 Male   China       UCBL        1996-12-14   171   25.3
## 20 Male   China       UCBL        1997-08-21   164.  24.6</code></pre>
<div class="sourceCode" id="cb466"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Using `filter()`, show data only for</span>
<span class="co"># - Chinese people</span>
<span class="va">pp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">origin</span><span class="op">==</span><span class="st">'China'</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 7
##   name     gender origin institution dateofbirth  size   age
##   &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;       &lt;date&gt;      &lt;dbl&gt; &lt;dbl&gt;
## 1 Yiran    Male   China  UCBL        1995-02-04   188.  27.2
## 2 Leran    Male   China  UCBL        1992-12-30   186   29.3
## 3 Peng     Male   China  UCBL        1996-12-14   171   25.3
## 4 Mingyuan Male   China  UCBL        1997-08-21   164.  24.6</code></pre>
<div class="sourceCode" id="cb468"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># - From institution ECL and UCBL</span>
<span class="va">pp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">institution</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ECL'</span>, <span class="st">'UCBL'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 13 × 7
##    name     gender origin  institution dateofbirth  size   age
##    &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;       &lt;date&gt;      &lt;dbl&gt; &lt;dbl&gt;
##  1 Salem    Male   Yemen   UCBL        1997-12-26   161.  24.3
##  2 Hanna    Female Ukraine ECL         1997-12-30   165.  24.3
##  3 Benedikt Male   Austria UCBL        1995-04-25   176.  27.0
##  4 Jordyn   Female USA     ECL         1997-02-19   176.  25.1
##  5 Jennifer Female USA     ECL         1995-05-28   179   26.9
##  6 Yiran    Male   China   UCBL        1995-02-04   188.  27.2
##  7 Leran    Male   China   UCBL        1992-12-30   186   29.3
##  8 Pavlo    Male   Ukraine ECL         1997-04-12   151.  25.0
##  9 Saulo    Male   Brazil  ECL         1994-09-24   184.  27.5
## 10 Ihor     Male   Ukraine ECL         1999-10-03   170.  22.5
## 11 Iryna    Female Ukraine ECL         1993-02-27   192   29.1
## 12 Peng     Male   China   UCBL        1996-12-14   171   25.3
## 13 Mingyuan Male   China   UCBL        1997-08-21   164.  24.6</code></pre>
<div class="sourceCode" id="cb470"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># - People older than 22 </span>
<span class="va">pp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">age</span><span class="op">&gt;</span><span class="fl">22</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 20 × 7
##    name                    gender origin     institution dateofbirth  size   age
##    &lt;chr&gt;                   &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;       &lt;date&gt;      &lt;dbl&gt; &lt;dbl&gt;
##  1 Salem                   Male   Yemen      UCBL        1997-12-26   161.  24.3
##  2 Dilruwan-Shanaka-Perera Male   Sri Lanka  INSA        1997-03-28   172.  25.0
##  3 Hanna                   Female Ukraine    ECL         1997-12-30   165.  24.3
##  4 Sabin                   Male   India      INSA        1995-08-04   186.  26.7
##  5 Benedikt                Male   Austria    UCBL        1995-04-25   176.  27.0
##  6 Jordyn                  Female USA        ECL         1997-02-19   176.  25.1
##  7 Jennifer                Female USA        ECL         1995-05-28   179   26.9
##  8 Yiran                   Male   China      UCBL        1995-02-04   188.  27.2
##  9 Leran                   Male   China      UCBL        1992-12-30   186   29.3
## 10 Aymen                   Male   Tunisia    INSA        1990-03-03   160.  32.1
## 11 Pavlo                   Male   Ukraine    ECL         1997-04-12   151.  25.0
## 12 Saulo                   Male   Brazil     ECL         1994-09-24   184.  27.5
## 13 Nicolas-Estevan         Male   Colombia   INSA        1993-11-25   184.  28.4
## 14 Farzad                  Male   Iran       INSA        1996-12-27   183   25.3
## 15 Roein                   Male   Afghanist… INSA        1999-07-11   155.  22.7
## 16 Paraskevas              Male   Cyprus     INSA        1999-06-25   176.  22.8
## 17 Ihor                    Male   Ukraine    ECL         1999-10-03   170.  22.5
## 18 Iryna                   Female Ukraine    ECL         1993-02-27   192   29.1
## 19 Peng                    Male   China      UCBL        1996-12-14   171   25.3
## 20 Mingyuan                Male   China      UCBL        1997-08-21   164.  24.6</code></pre>
<div class="sourceCode" id="cb472"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># - People with a `e` in their name</span>
<span class="va">pp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">'e'</span>,<span class="va">name</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 7
##    name                    gender origin     institution dateofbirth  size   age
##    &lt;chr&gt;                   &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;       &lt;date&gt;      &lt;dbl&gt; &lt;dbl&gt;
##  1 Salem                   Male   Yemen      UCBL        1997-12-26   161.  24.3
##  2 Dilruwan-Shanaka-Perera Male   Sri Lanka  INSA        1997-03-28   172.  25.0
##  3 Benedikt                Male   Austria    UCBL        1995-04-25   176.  27.0
##  4 Jennifer                Female USA        ECL         1995-05-28   179   26.9
##  5 Leran                   Male   China      UCBL        1992-12-30   186   29.3
##  6 Aymen                   Male   Tunisia    INSA        1990-03-03   160.  32.1
##  7 Nicolas-Estevan         Male   Colombia   INSA        1993-11-25   184.  28.4
##  8 Roein                   Male   Afghanist… INSA        1999-07-11   155.  22.7
##  9 Paraskevas              Male   Cyprus     INSA        1999-06-25   176.  22.8
## 10 Peng                    Male   China      UCBL        1996-12-14   171   25.3</code></pre>
</details><hr>
<p>For more interesting exercises in the tidyverse, look at:</p>
<ul>
<li><a href="Exo/co2/exercise.html">CO2 emissions: data wrangling and ggplot2</a></li>
<li><a href="Exo/religion_babies/exercise.html">Religion and babies: data handling, ggplot2 and plotly</a></li>
<li><a href="Exo/covid/exercise.html">COVID-19: data wrangling, ggplot2</a></li>
<li><a href="Exo/SEM_particles/exercise.html">Nanoparticles statistics from SEM images: data wrangling, ggplot2 and fitting</a></li>
</ul>
<p><br><br><br><br><br></p>
<p><br><br><br><br><br></p>

</details>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="vectors.html"><span class="header-section-number">5</span> Vectors</a></div>
<div class="next"><a href="readingwriting-all-kinds-of-files.html"><span class="header-section-number">7</span> Reading/writing all kinds of files</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#data-frames"><span class="header-section-number">6</span> Data frames</a></li>
<li>
<a class="nav-link" href="#defining-a-data.frame"><span class="header-section-number">6.1</span> Defining a data.frame</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#defining-a-data.frame-from-vectors"><span class="header-section-number">6.1.1</span> Defining a data.frame from vectors</a></li>
<li><a class="nav-link" href="#defining-a-data.frame-from-a-file"><span class="header-section-number">6.1.2</span> Defining a data.frame from a file</a></li>
</ul>
</li>
<li><a class="nav-link" href="#accessing-values-1"><span class="header-section-number">6.2</span> Accessing values</a></li>
<li>
<a class="nav-link" href="#adding-columns-or-rows"><span class="header-section-number">6.3</span> Adding columns or rows</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#adding-columns"><span class="header-section-number">6.3.1</span> Adding columns</a></li>
<li><a class="nav-link" href="#adding-rows"><span class="header-section-number">6.3.2</span> Adding rows</a></li>
<li><a class="nav-link" href="#deleting-rowscolumns"><span class="header-section-number">6.3.3</span> Deleting rows/columns</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#tidy-up"><span class="header-section-number">6.4</span> Tidy up!</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#what-is-tidy-data"><span class="header-section-number">6.4.1</span> What is tidy data?</a></li>
<li><a class="nav-link" href="#tibbles"><span class="header-section-number">6.4.2</span> Tibbles</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#operations-in-the-tidyverse"><span class="header-section-number">6.5</span> Operations in the tidyverse</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#the-pipe-operator"><span class="header-section-number">6.5.1</span> The pipe operator</a></li>
<li><a class="nav-link" href="#sampling-data"><span class="header-section-number">6.5.2</span> Sampling data</a></li>
<li><a class="nav-link" href="#operations-on-groups-of-a-variable"><span class="header-section-number">6.5.3</span> Operations on groups of a variable</a></li>
<li><a class="nav-link" href="#summary-by-groups-of-a-variable"><span class="header-section-number">6.5.4</span> Summary by groups of a variable</a></li>
<li><a class="nav-link" href="#sorting"><span class="header-section-number">6.5.5</span> Sorting</a></li>
<li><a class="nav-link" href="#merge-tables-column-wise"><span class="header-section-number">6.5.6</span> Merge tables column-wise</a></li>
<li><a class="nav-link" href="#merge-tables-row-wise"><span class="header-section-number">6.5.7</span> Merge tables row-wise</a></li>
<li><a class="nav-link" href="#addmodify-a-column"><span class="header-section-number">6.5.8</span> Add/modify a column</a></li>
<li><a class="nav-link" href="#selecting-columns"><span class="header-section-number">6.5.9</span> Selecting columns</a></li>
<li><a class="nav-link" href="#filtering-columns"><span class="header-section-number">6.5.10</span> Filtering columns</a></li>
<li><a class="nav-link" href="#reorder-columns"><span class="header-section-number">6.5.11</span> Reorder columns</a></li>
<li><a class="nav-link" href="#separate-columns"><span class="header-section-number">6.5.12</span> Separate columns</a></li>
<li><a class="nav-link" href="#apply-a-function-recursively-on-each-element-of-a-column"><span class="header-section-number">6.5.13</span> Apply a function recursively on each element of a column</a></li>
<li><a class="nav-link" href="#nesting-and-un-nesting-data"><span class="header-section-number">6.5.14</span> Nesting and un-nesting data</a></li>
<li><a class="nav-link" href="#providing-data-to-ggplot"><span class="header-section-number">6.5.15</span> Providing data to ggplot</a></li>
</ul>
</li>
<li><a class="nav-link" href="#exo-df"><span class="header-section-number">6.6</span> Exercises</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/colinbousige/Rclass/blob/master/07-dataframes.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/colinbousige/Rclass/edit/master/07-dataframes.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Reproducible data treatment with R</strong>: An introduction" was written by Colin Bousige. It was last built on 07/04/2022.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
