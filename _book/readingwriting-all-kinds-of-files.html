<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>7 Reading/writing all kinds of files | Reproducible data treatment with R</title>
<meta name="author" content="Colin Bousige">
<meta name="generator" content="bookdown 0.25 with bs4_book()">
<meta property="og:title" content="7 Reading/writing all kinds of files | Reproducible data treatment with R">
<meta property="og:type" content="book">
<meta property="og:url" content="https://lmi.cnrs.fr/r/readingwriting-all-kinds-of-files.html">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="7 Reading/writing all kinds of files | Reproducible data treatment with R">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="libs/plotly-binding-4.10.0/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-152051691-1"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-152051691-1');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
<meta name="description" content="blockquote {  background: #E9F9FF;  border-left: 5px solid #026086;  margin: 1.5em 10px;  padding: 0.5em 10px; }  7.1 Reading files Working in any data-based scientific field, you will encounter...">
<meta property="og:description" content="blockquote {  background: #E9F9FF;  border-left: 5px solid #026086;  margin: 1.5em 10px;  padding: 0.5em 10px; }  7.1 Reading files Working in any data-based scientific field, you will encounter...">
<meta name="twitter:description" content="blockquote {  background: #E9F9FF;  border-left: 5px solid #026086;  margin: 1.5em 10px;  padding: 0.5em 10px; }  7.1 Reading files Working in any data-based scientific field, you will encounter...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="An introduction">Reproducible data treatment with R</a>:
        <small class="text-muted">An introduction</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="about-the-class.html"><span class="header-section-number">1</span> About the class</a></li>
<li><a class="" href="a-little-reminder-on-statistics.html"><span class="header-section-number">2</span> A little reminder on Statistics</a></li>
<li><a class="" href="getting-ready.html"><span class="header-section-number">3</span> Getting ready</a></li>
<li><a class="" href="variables-booleans-and-strings.html"><span class="header-section-number">4</span> Variables, booleans and strings</a></li>
<li><a class="" href="vectors.html"><span class="header-section-number">5</span> Vectors</a></li>
<li><a class="" href="data-frames.html"><span class="header-section-number">6</span> Data frames</a></li>
<li><a class="active" href="readingwriting-all-kinds-of-files.html"><span class="header-section-number">7</span> Reading/writing all kinds of files</a></li>
<li><a class="" href="lists.html"><span class="header-section-number">8</span> Lists</a></li>
<li><a class="" href="functions.html"><span class="header-section-number">9</span> Functions</a></li>
<li><a class="" href="conditional-actions-and-loops.html"><span class="header-section-number">10</span> Conditional actions and loops</a></li>
<li><a class="" href="plotting.html"><span class="header-section-number">11</span> Plotting</a></li>
<li><a class="" href="colorplots.html"><span class="header-section-number">12</span> 3D color plots</a></li>
<li><a class="" href="fitting.html"><span class="header-section-number">13</span> Fitting</a></li>
<li><a class="" href="writing-documents-with-rmarkdown.html"><span class="header-section-number">14</span> Writing documents with Rmarkdown</a></li>
<li><a class="" href="graphical-interfaces-with-shiny.html"><span class="header-section-number">15</span> Graphical interfaces with Shiny</a></li>
<li><a class="" href="working-with-units-and-experimental-errors.html"><span class="header-section-number">16</span> Working with units and experimental errors</a></li>
<li><a class="" href="list-of-exercises.html"><span class="header-section-number">17</span> List of exercises</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/colinbousige/Rclass">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="readingwriting-all-kinds-of-files" class="section level1" number="7">
<h1>
<span class="header-section-number">7</span> Reading/writing all kinds of files<a class="anchor" aria-label="anchor" href="#readingwriting-all-kinds-of-files"><i class="fas fa-link"></i></a>
</h1>
<style type="text/css">
blockquote {
  background: #E9F9FF;
  border-left: 5px solid #026086;
  margin: 1.5em 10px;
  padding: 0.5em 10px;
}
</style>
<div id="reading-files" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> Reading files<a class="anchor" aria-label="anchor" href="#reading-files"><i class="fas fa-link"></i></a>
</h2>
<p>Working in any data-based scientific field, you will encounter many different types of files. ASCII text files are usually predominant, but you may want to read files from coming from Excel, Origin, etc.
Here is a non-exhaustive reminder to help you read the kinds of files you often encounter with R. I invite you to visit the <a href="https://ropensci.org/">RopenSci webpage</a> for more packages, and if this isn’t enough for your need, well, <a href="http://letmegooglethat.com/?q=r+read+my+file+type">Google is your friend</a>.</p>
<div id="column-text-files" class="section level3" number="7.1.1">
<h3>
<span class="header-section-number">7.1.1</span> Column text files<a class="anchor" aria-label="anchor" href="#column-text-files"><i class="fas fa-link"></i></a>
</h3>
<p>Most base R functions like <code class="sourceCode r"><span class="fu">read.csv</span>()</code> or <code class="sourceCode r"><span class="fu">read.table</span>()</code> have their <code>tidyverse</code> counterpart, like <code class="sourceCode r"><span class="fu">read_csv</span>()</code> and <code class="sourceCode r"><span class="fu">read_table</span>()</code>. I usually prefer the <code>tidyverse</code> version as it outputs a <code>tibble</code> instead of a <code>data.frame</code>. These functions can also be directly provided with an url to the text file.</p>
<p>If your data file is “complicated” – in the sense that it contains lines or columns to be skipped – look at the help on the reader function with <code>?function_name</code>.</p>
<div id="comma-separated-values" class="section level4" number="7.1.1.1">
<h4>
<span class="header-section-number">7.1.1.1</span> Comma separated values<a class="anchor" aria-label="anchor" href="#comma-separated-values"><i class="fas fa-link"></i></a>
</h4>
<p>Input file looks like this:</p>
<pre><code>## Country Name,Country Code,Year,Value
## Arab World,ARB,1960,92490932
## Arab World,ARB,1961,95044497
## Arab World,ARB,1962,97682294
## Arab World,ARB,1963,100411076
## Arab World,ARB,1964,103239902
## Arab World,ARB,1965,106174988
## Arab World,ARB,1966,109230593
## Arab World,ARB,1967,112406932
## Arab World,ARB,1968,115680165</code></pre>
<div class="sourceCode" id="cb475"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"Data/tot_population.csv"</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 14,885 × 4
##    `Country Name` `Country Code`  Year     Value
##    &lt;chr&gt;          &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;
##  1 Arab World     ARB             1960  92490932
##  2 Arab World     ARB             1961  95044497
##  3 Arab World     ARB             1962  97682294
##  4 Arab World     ARB             1963 100411076
##  5 Arab World     ARB             1964 103239902
##  6 Arab World     ARB             1965 106174988
##  7 Arab World     ARB             1966 109230593
##  8 Arab World     ARB             1967 112406932
##  9 Arab World     ARB             1968 115680165
## 10 Arab World     ARB             1969 119016542
## # … with 14,875 more rows</code></pre>
<div class="sourceCode" id="cb477"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"Data/tot_population.csv"</span>, skip <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 14,884 × 4
##    `Arab World` ARB   `1960` `92490932`
##    &lt;chr&gt;        &lt;chr&gt;  &lt;dbl&gt;      &lt;dbl&gt;
##  1 Arab World   ARB     1961   95044497
##  2 Arab World   ARB     1962   97682294
##  3 Arab World   ARB     1963  100411076
##  4 Arab World   ARB     1964  103239902
##  5 Arab World   ARB     1965  106174988
##  6 Arab World   ARB     1966  109230593
##  7 Arab World   ARB     1967  112406932
##  8 Arab World   ARB     1968  115680165
##  9 Arab World   ARB     1969  119016542
## 10 Arab World   ARB     1970  122398374
## # … with 14,874 more rows</code></pre>
<div class="sourceCode" id="cb479"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"Data/tot_population.csv"</span>, skip <span class="op">=</span> <span class="fl">1</span>, col_names <span class="op">=</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 14,885 × 4
##    A          B         C         D
##    &lt;chr&gt;      &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt;
##  1 Arab World ARB    1960  92490932
##  2 Arab World ARB    1961  95044497
##  3 Arab World ARB    1962  97682294
##  4 Arab World ARB    1963 100411076
##  5 Arab World ARB    1964 103239902
##  6 Arab World ARB    1965 106174988
##  7 Arab World ARB    1966 109230593
##  8 Arab World ARB    1967 112406932
##  9 Arab World ARB    1968 115680165
## 10 Arab World ARB    1969 119016542
## # … with 14,875 more rows</code></pre>
<p>Since version 2.0 of <code>readr</code>, <code class="sourceCode r"><span class="fu">read_csv</span>()</code> can also take a vector as argument, which will result in reading all files in the vector successively:</p>
<div class="sourceCode" id="cb481"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Data/test1.csv"</span>,
           <span class="st">"Data/test2.csv"</span><span class="op">)</span>,
         id <span class="op">=</span> <span class="st">"file"</span>, show_col_types <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 3
##   file           name  value
##   &lt;chr&gt;          &lt;chr&gt; &lt;dbl&gt;
## 1 Data/test1.csv John      3
## 2 Data/test1.csv Doe       2
## 3 Data/test2.csv Colin     5
## 4 Data/test2.csv Louis     8</code></pre>
</div>
<div id="space-separated-values" class="section level4" number="7.1.1.2">
<h4>
<span class="header-section-number">7.1.1.2</span> Space separated values<a class="anchor" aria-label="anchor" href="#space-separated-values"><i class="fas fa-link"></i></a>
</h4>
<p>Input file looks like this:</p>
<pre><code>## 3063.7136    43.916748
## 3063.991 47.916748
## 3064.2668    44.5
## 3064.5442    50.5
## 3064.8201    50.5
## 3065.0972    44.5
## 3065.373 44.916748
## 3065.6504    39.916748
## 3065.9263    49.5
## 3066.2034    48.916748</code></pre>
<div class="sourceCode" id="cb484"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="fu"><a href="https://readr.tidyverse.org/reference/read_table.html">read_table</a></span><span class="op">(</span><span class="st">"Data/rubis_01.txt"</span><span class="op">)</span>
<span class="fu"><a href="https://readr.tidyverse.org/reference/read_table.html">read_table</a></span><span class="op">(</span><span class="st">"Data/rubis_01.txt"</span>, col_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"w"</span>,<span class="st">"int"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="other-separators" class="section level4" number="7.1.1.3">
<h4>
<span class="header-section-number">7.1.1.3</span> Other separators<a class="anchor" aria-label="anchor" href="#other-separators"><i class="fas fa-link"></i></a>
</h4>
<p>For tab-separated values, use <code class="sourceCode r"><span class="fu">read_tsv</span>()</code>. For other exotic separators, look into <code class="sourceCode r"><span class="fu">read_delim</span>()</code>.</p>
</div>
</div>
<div id="excel-files" class="section level3" number="7.1.2">
<h3>
<span class="header-section-number">7.1.2</span> Excel files<a class="anchor" aria-label="anchor" href="#excel-files"><i class="fas fa-link"></i></a>
</h3>
<p>For this, use the <code>readxl</code> library and its function <code class="sourceCode r"><span class="fu">read_excel</span>()</code> returning a <code>tibble</code>:</p>
<div class="sourceCode" id="cb485"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span>
<span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"Data/test.xlsx"</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 2
##        x      y
##    &lt;dbl&gt;  &lt;dbl&gt;
##  1     1  5.21 
##  2     2  6.55 
##  3     3  3.71 
##  4     4  0.216
##  5     5  0.205
##  6     6  4.60 
##  7     7 10.3  
##  8     8 12.9  
##  9     9 11.1  
## 10    10  7.28</code></pre>
<div class="sourceCode" id="cb487"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"Data/test.xlsx"</span>, sheet<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="co"># specify the sheet by its number or its name</span></code></pre></div>
<pre><code>## # A tibble: 4 × 2
##   hello  world   
##   &lt;chr&gt;  &lt;chr&gt;   
## 1 ac     th      
## 2 asc    thh     
## 3 ascsa  dthdh   
## 4 ascacs dthtdhdh</code></pre>
<p>In case your Excel file contains merged cells, <code class="sourceCode r"><span class="fu">read_excel</span>()</code> will fill the merged cells by <code>NA</code> values. If you want to avoid this behavior, use <code class="sourceCode r">openxlsx<span class="sc">::</span><span class="fu">read.xlsx</span>()</code> (which returns a <code>data.frame</code>):</p>
<div class="sourceCode" id="cb489"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"Data/test.xlsx"</span>, sheet<span class="op">=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
##   a         b ...3 
##   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;
## 1 &lt;NA&gt;     12 t    
## 2 &lt;NA&gt;     13 h    
## 3 &lt;NA&gt;     14 d    
## 4 b        15 f    
## 5 &lt;NA&gt;     16 g</code></pre>
<div class="sourceCode" id="cb491"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ycphs.github.io/openxlsx/index.html">openxlsx</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="st">"Data/test.xlsx"</span>, fillMergedCells <span class="op">=</span> <span class="cn">TRUE</span>, sheet <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##   a  b b
## 1 a 12 t
## 2 a 13 h
## 3 a 14 d
## 4 b 15 f
## 5 b 16 g</code></pre>
</div>
<div id="origin-files" class="section level3" number="7.1.3">
<h3>
<span class="header-section-number">7.1.3</span> Origin files<a class="anchor" aria-label="anchor" href="#origin-files"><i class="fas fa-link"></i></a>
</h3>
<p>If you moved to R coming from a workflow where you used <a href="https://www.originlab.com/origin">Origin</a>, chances are you have some .opj files lying around that you still want to be able to read. Lucky you, the <code>Ropj</code> library is here:</p>
<div class="sourceCode" id="cb493"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/aitap/Ropj">Ropj</a></span><span class="op">)</span>
<span class="fu">read.opj</span><span class="op">(</span><span class="st">"Data/opjfile.opj"</span><span class="op">)</span></code></pre></div>
</div>
<div id="matlab-files" class="section level3" number="7.1.4">
<h3>
<span class="header-section-number">7.1.4</span> Matlab files<a class="anchor" aria-label="anchor" href="#matlab-files"><i class="fas fa-link"></i></a>
</h3>
<p>To read Matlab’s .mat format datasets, use the <a href="https://github.com/HenrikBengtsson/R.matlab">R.matlab package</a> and its <code class="sourceCode r"><span class="fu">readMat</span>()</code> function.</p>
<div class="sourceCode" id="cb494"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/HenrikBengtsson/R.matlab">R.matlab</a></span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">readMat</span><span class="op">(</span><span class="st">"yourfile.mat"</span><span class="op">)</span></code></pre></div>
</div>
<div id="images" class="section level3" number="7.1.5">
<h3>
<span class="header-section-number">7.1.5</span> Images<a class="anchor" aria-label="anchor" href="#images"><i class="fas fa-link"></i></a>
</h3>
<p>You can read an image as a matrix. For example:</p>
<div class="sourceCode" id="cb495"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.rforge.net/png/">png</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/png/man/readPNG.html">readPNG</a></span><span class="op">(</span><span class="st">"image.png"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.rforge.net/tiff/">tiff</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/tiff/man/readTIFF.html">readTIFF</a></span><span class="op">(</span><span class="st">"image.tiff"</span><span class="op">)</span></code></pre></div>
<p>For more image processing (pictures or videos), I recommend the <a href="https://dahtah.github.io/imager/imager.html"><code>imager</code> package</a>.</p>
</div>
<div id="spectroscopic-files" class="section level3" number="7.1.6">
<h3>
<span class="header-section-number">7.1.6</span> Spectroscopic files<a class="anchor" aria-label="anchor" href="#spectroscopic-files"><i class="fas fa-link"></i></a>
</h3>
<p>In case your spectroscopic data wasn’t saved as an ASCII file but as a <code>spc</code> or another format, take a look at the <a href="https://docs.ropensci.org/lightr/"><code>lightr</code> package</a>, for example.</p>
<p>Example of a reading function for an spc file:</p>
<div class="sourceCode" id="cb496"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/lightr/">lightr</a></span><span class="op">)</span>
<span class="va">read_spc</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fname</span><span class="op">)</span><span class="op">{</span>
    <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/lightr/reference/lr_parse_spc.html">lr_parse_spc</a></span><span class="op">(</span><span class="va">fname</span><span class="op">)</span> <span class="co"># d is a list</span>
    <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>w         <span class="op">=</span> <span class="va">d</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">wl</span>, 
           intensity <span class="op">=</span> <span class="va">d</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">processed</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="compressed-binary-data-files-hdf-netcdf" class="section level3" number="7.1.7">
<h3>
<span class="header-section-number">7.1.7</span> Compressed binary data files: HDF, netCDF<a class="anchor" aria-label="anchor" href="#compressed-binary-data-files-hdf-netcdf"><i class="fas fa-link"></i></a>
</h3>
<p><strong>HDF</strong>: Go to <a href="https://www.bioconductor.org/packages/release/bioc/vignettes/rhdf5/inst/doc/rhdf5.html">this vignette</a> to see how to read Hierarchical Data Files.</p>
<p><strong>netCDF</strong>: see <a href="https://www.rdocumentation.org/packages/RNetCDF/versions/2.4-2/topics/read.nc">here</a>.</p>
</div>
</div>
<div id="reading-multiple-files-into-a-tidy-table" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> Reading multiple files into a tidy table<a class="anchor" aria-label="anchor" href="#reading-multiple-files-into-a-tidy-table"><i class="fas fa-link"></i></a>
</h2>
<p>We very often encounter the situation where we need to read multiple similar files into a tidy table.
For this, you can use a <code class="sourceCode r"><span class="cf">for</span></code> loop: this would work but would be un-R-ly, but in some cases you need to do this because you perform some other operations during the <code>for</code> loop.</p>
<p>Let’s say we store the list of file names into a vector <code>file_list</code> and read these files using the function <code class="sourceCode r"><span class="fu">read_function</span>()</code>:</p>
<div class="sourceCode" id="cb497"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># empty initialization</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">file</span> <span class="kw">in</span> <span class="va">file_list</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">df_temp</span> <span class="op">&lt;-</span> <span class="fu">read_function</span><span class="op">(</span><span class="va">file</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>name <span class="op">=</span> <span class="va">file</span><span class="op">)</span> <span class="co"># add the column `name` to make the tibble tidy</span>
    <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">def_temp</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>An R-friendly way of doing this would be to avoid using a <code class="sourceCode r"><span class="cf">for</span></code> loop:</p>
<div class="sourceCode" id="cb498"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>name <span class="op">=</span> <span class="va">file_list</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">read_function</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></code></pre></div>
<p>In case you are reading csv files, you can use the fact that since the version 2.0 of <code>readr</code>, <code class="sourceCode r"><span class="fu">read_csv</span>()</code> takes a vector as first argument. You’ll also need to use the <code>id</code> argument to get a column with the list of file names:</p>
<div class="sourceCode" id="cb499"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="va">file_list</span>, id <span class="op">=</span> <span class="st">"name"</span><span class="op">)</span></code></pre></div>
</div>
<div id="writing-files" class="section level2" number="7.3">
<h2>
<span class="header-section-number">7.3</span> Writing files<a class="anchor" aria-label="anchor" href="#writing-files"><i class="fas fa-link"></i></a>
</h2>
<div id="text-files" class="section level3" number="7.3.1">
<h3>
<span class="header-section-number">7.3.1</span> Text files<a class="anchor" aria-label="anchor" href="#text-files"><i class="fas fa-link"></i></a>
</h3>
<p>Sometimes, you want to output your data as a csv or an Excel file to share it with others or to save your data. Use the <code class="sourceCode r"><span class="fu">write_csv</span>()</code> function to write a csv file (prefer the <code>tidyverse</code>’s <code class="sourceCode r"><span class="fu">write_csv</span>()</code> to the base R <code class="sourceCode r"><span class="fu">write.csv</span>()</code> as it is more easy to use):</p>
<div class="sourceCode" id="cb500"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv</a></span><span class="op">(</span><span class="va">df</span>, <span class="st">"your_file.csv"</span><span class="op">)</span></code></pre></div>
<p>Note that the <code class="sourceCode r">write_<span class="sc">*</span>()</code> functions will automatically compress outputs if an appropriate extension is given. Three extensions are currently supported: .gz for gzip compression, .bz2 for bzip2 compression and .xz for lzma compression. See the examples in the help for more information.</p>
<p>If you don’t want to use csv files, look into <code class="sourceCode r"><span class="fu">write_tsv</span>()</code> for tab-separated values or <code class="sourceCode r"><span class="fu">write_delim</span>()</code> for any delimiter. In case you want to output fixed width files, look into <a href="https://www.rdocumentation.org/packages/gdata/versions/2.18.0/topics/write.fwf"><code>gdata</code>’s <code class="sourceCode r"><span class="fu">write.fwf</span>()</code></a>.</p>
</div>
<div id="excel-files-1" class="section level3" number="7.3.2">
<h3>
<span class="header-section-number">7.3.2</span> Excel files<a class="anchor" aria-label="anchor" href="#excel-files-1"><i class="fas fa-link"></i></a>
</h3>
<p>To write Excel files, use the library <code>openxlsx</code> and its function <code class="sourceCode r"><span class="fu">write.xlsx</span>()</code> (see the help on the function for more options):</p>
<div class="sourceCode" id="cb501"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ycphs.github.io/openxlsx/index.html">openxlsx</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/write.xlsx.html">write.xlsx</a></span><span class="op">(</span><span class="va">df</span>, <span class="st">"your_file.xlsx"</span><span class="op">)</span></code></pre></div>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="data-frames.html"><span class="header-section-number">6</span> Data frames</a></div>
<div class="next"><a href="lists.html"><span class="header-section-number">8</span> Lists</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#readingwriting-all-kinds-of-files"><span class="header-section-number">7</span> Reading/writing all kinds of files</a></li>
<li>
<a class="nav-link" href="#reading-files"><span class="header-section-number">7.1</span> Reading files</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#column-text-files"><span class="header-section-number">7.1.1</span> Column text files</a></li>
<li><a class="nav-link" href="#excel-files"><span class="header-section-number">7.1.2</span> Excel files</a></li>
<li><a class="nav-link" href="#origin-files"><span class="header-section-number">7.1.3</span> Origin files</a></li>
<li><a class="nav-link" href="#matlab-files"><span class="header-section-number">7.1.4</span> Matlab files</a></li>
<li><a class="nav-link" href="#images"><span class="header-section-number">7.1.5</span> Images</a></li>
<li><a class="nav-link" href="#spectroscopic-files"><span class="header-section-number">7.1.6</span> Spectroscopic files</a></li>
<li><a class="nav-link" href="#compressed-binary-data-files-hdf-netcdf"><span class="header-section-number">7.1.7</span> Compressed binary data files: HDF, netCDF</a></li>
</ul>
</li>
<li><a class="nav-link" href="#reading-multiple-files-into-a-tidy-table"><span class="header-section-number">7.2</span> Reading multiple files into a tidy table</a></li>
<li>
<a class="nav-link" href="#writing-files"><span class="header-section-number">7.3</span> Writing files</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#text-files"><span class="header-section-number">7.3.1</span> Text files</a></li>
<li><a class="nav-link" href="#excel-files-1"><span class="header-section-number">7.3.2</span> Excel files</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/colinbousige/Rclass/blob/master/08-reading_files.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/colinbousige/Rclass/edit/master/08-reading_files.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Reproducible data treatment with R</strong>: An introduction" was written by Colin Bousige. It was last built on 07/04/2022.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
