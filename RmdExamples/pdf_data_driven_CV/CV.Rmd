---
name: John
surname: Doe
date: "`r format(Sys.time(), '%B, %Y')`"
qualifications: PhD
position: Research Scientist
address: My Fancy Lab name
email: john.doe@cnrs.fr
website: https://johndoe.github.io/
github: johndoe
googlescholar: 123456
orcid: 0000-1111-2222-3333
phone: +1 22 33 44 55 66
headcolor: 414141 # for no headcolor
header-includes:
    - \definecolor{BLUE}{RGB}{64, 61, 141}
    - \hypersetup{colorlinks=true,linkcolor=BLUE,citecolor=BLUE,urlcolor=BLUE}
output: 
  vitae::awesomecv
---

```{r setup, include=FALSE}
library(tidyverse)
library(glue)
library(vitae)
library(httr)
knitr::opts_chunk$set(echo = FALSE)
bibfile <- "biblio.bib"
myname  <- "Doe"
```

# Professional Experience

```{r consulting}
tribble(
  ~ lab, ~ position, ~ city, ~ dates, ~ details,
  "My Fancy Lab name", "Research Scientist", "Lyon, France", "Oct. 2017 - Present", 
    list("I do this",
         "and that")
) %>% 
  detailed_entries(lab, dates, position, city, details)
```

# Education

```{r education}
tribble(
  ~ degree, ~ uni, ~ loc, ~ dates, ~ details,
  "PhD, Sciences", "My University", "City, Country", "Mar. 2014 - Nov. 2017", 
    list("Recipient of the Fancy Honours Memorial Scholarship",
         "Honours research project was to develop this and that",
         "Studied units include this nice stuff."),
  "M2, Sciences", "My old University", "City2, Country2", "2013 - 2014", 
    list("Recipient of the City Community Leaders Scholarship.",
         "Participant of this nice program.",
         "Studied a broad range of units covering many aspects of data science.")
) %>% 
  detailed_entries(degree, dates, uni, loc, details)
```

# Teaching experience

## Teaching

Some blah blah

```{r tutoring}
tribble(
  ~ title, ~ code, ~ where, ~ when,
  "Applied stuff", "AAA111", "City", "2021 S1",
  "Communicating stuff", "AAA222", "City", "2020 S2", 
  "Theroretical stuff", "AAA333", "City", "2020 S1"
) %>% 
  brief_entries(glue::glue("\\textbf{<code>}: <title> (<where>)", .open = "<", .close = ">"), when, .protect = FALSE)
```

## Student mentoring

Some blah blah

```{r mentoring}
tribble(
  ~ studentname, ~ level, ~ where, ~ year, ~what,
  "John", "M1", "University of Lyon", "2017", "internship on this and that",
  "Lisa", "PhD", "University of Boston", "2018-2021", NA
) %>% 
    arrange(desc(year)) %>% 
    mutate(toprint = glue::glue("\\textbf{<studentname>} (<level>)", .open = "<", .close = ">")) %>% 
    mutate(toprint = ifelse(!is.na(what), 
                            glue::glue("{toprint}: {what}"), 
                            toprint)) %>% 
    brief_entries(toprint, year, where, .protect = FALSE)
```


# Presentations at international conferences

```{r talks}
tribble(
  ~ when, ~ title, ~ details, ~ where, ~ url,
  "2020", "Forecasting stuff", "Methods and techniques to stuff", "My Conference", "https://my.slides.com",
  "2020", "Probabilistic bidule", NA, "Other Conference", "https://my.other.slides.com",
  "2019", "Flexible futures for my kids", "A description.", "Conference 3", NA
) %>% 
    mutate(toprint = glue::glue("\\textbf{<title>}", .open = "<", .close = ">")) %>% 
    mutate(toprint = ifelse(!is.na(details), 
                            glue::glue("{toprint}: {details}"), 
                            toprint)) %>% 
    mutate(toprint = ifelse(!is.na(url), 
                            glue::glue("<toprint>\\newline \\url{<url>}", .open = "<", .close = ">"),
                            toprint)) %>% 
    brief_entries(toprint, when, where, .protect = FALSE)
```


# Awards & Achievements

```{r}
tribble(
  ~ award, ~ from, ~ year,
  "Dean's Honour", "City", "2012",
  "Dean's Commendation", "City", "2014",
) %>%
  brief_entries(award, year, from)
```

\clearpage

# Publications

```{r, warning=FALSE, message=FALSE}
reverse_names <- function(name="Amaral, I. R.") {
    name_list <- unlist(str_split(name, ", "))
    initial <- paste0(unlist(str_split(name_list[2], ""))[1],".")
    paste(initial, name_list[1])
}
parse_authors <- function(aut_list=pubs$AUTHOR[[1]], author=myname) {
    aut_list <- map_chr(aut_list, reverse_names)
    aut_list[grep(tolower(author), tolower(aut_list))] <- 
        paste0("\\textbf{", 
                aut_list[grep(tolower(author), tolower(aut_list))], 
                "}")
    aut_list <- unique(aut_list)
    aut_list <- paste(aut_list, collapse = ", ")
}
parse_journal <- function(JOURNAL, VOLUME, PAGES, YEAR) {
    out <- paste0(JOURNAL, " \\textbf{", VOLUME, "} (", YEAR, "), ", PAGES)
    out <- gsub(" \\\\textbf\\{NA\\}", "", out)
    gsub(", NA", "", out)
}
pubs <- bib2df::bib2df(bibfile) %>% 
    filter(str_detect(tolower(AUTHOR), tolower(myname)), 
           !is.na(DOI))  %>% 
    arrange(desc(YEAR)) %>% 
    select(TITLE, AUTHOR, YEAR, JOURNAL, VOLUME, PAGES, DOI) %>% 
    mutate(count = n()-row_number()+1,
           AUTHOR = map_chr(AUTHOR, parse_authors), 
           TITLE = glue("[<count>]~\\href{http://doi.org/<DOI>}{<TITLE>}", .open = "<", .close = ">"),
           JOURNAL = parse_journal(JOURNAL,VOLUME,PAGES,YEAR))
pubs %>%
    detailed_entries(
        what = AUTHOR,
        with = TITLE,
        where = JOURNAL,
        .protect = FALSE
    )
```

